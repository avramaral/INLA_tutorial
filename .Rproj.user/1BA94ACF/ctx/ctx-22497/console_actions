{
    "type": [
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        3,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        3,
        0,
        1,
        2,
        2,
        2,
        0,
        1,
        3,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        3,
        0,
        1,
        2,
        2,
        2,
        0,
        1,
        3,
        0,
        1,
        3,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2
    ],
    "data": [
        "32.56\n314 7.546599 -1999.429 5732.56\n315 7.493581 -1974.429 5732.56\n316 7.342971 -1949.429 5732.56\n317 7.208915 -1924.429 5732.56\n318 7.101068 -1899.429 5732.56\n319 6.993223 -1874.429 5732.56\n320 6.885378 -1849.429 5732.56\n321 6.777533 -1824.429 5732.56\n322 6.669687 -1799.429 5732.56\n323 6.561838 -1774.429 5732.56\n324 6.486408 -1749.429 5732.56\n325 6.686241 -1724.429 5732.56\n326 6.886035 -1699.429 5732.56\n327 7.085857 -1674.429 5732.56\n328 7.251401 -1649.429 5732.56\n329 7.313453 -1624.429 5732.56\n330 7.3755",
        "10 -1599.429 5732.56\n331 7.227296 -1574.429 5732.56\n332 6.987557 -1549.429 5732.56\n333 6.747846 -1524.429 5732.56\n [ reached 'max' / getOption(\"max.print\") -- omitted 13349 rows ]\n",
        "> ",
        "# Fitted values and prediction",
        "> ",
        "idxs_pred <- inla.stack.index(stk_full, tag = \"pred\")$data",
        "> ",
        "pred_mm <- as.data.frame(cbind(coord_pred, model_4_1$summary.fitted.values[idxs_pred, \"mean\"]))",
        "> ",
        "pred_ll <- as.data.frame(cbind(coord_pred, model_4_1$summary.fitted.values[idxs_pred, \"0.025quant\"]))",
        "> ",
        "pred_ul <- as.data.frame(cbind(coord_pred, model_4_1$summary.fitted.values[idxs_pred, \"0.975quant\"]))",
        "> ",
        "tt <- \"Posterior Mean\"",
        "> ",
        "coordinates(pred_mm) <- ~ x + y",
        "> ",
        "gridded(pred_mm) <- TRUE",
        "> ",
        "pred_mm <- raster(pred_mm)",
        "> ",
        "crs(pred_mm) <- \"+init=epsg:6345 +units=km +no_defs\"",
        "> ",
        "pred_mm    <- as(pred_mm, \"SpatialPixelsDataFrame\")",
        "> ",
        "pred_mm_df <- as.data.frame(pred_mm)",
        "> ",
        "tt <- \"Posterior Mean\"",
        "> ",
        "coordinates(pred_mm) <- ~ x + y",
        "Error in `coordinates<-`(`*tmp*`, value = ~x + y) : \n  setting coordinates cannot be done on Spatial objects, where they have already been set\n",
        "> ",
        "gridded(pred_mm) <- TRUE",
        "> ",
        "pred_mm <- raster(pred_mm)",
        "> ",
        "crs(pred_mm) <- \"+init=epsg:6345 +units=km +no_defs\"",
        "> ",
        "pred_mm <- as.data.frame(cbind(coord_pred, model_4_1$summary.fitted.values[idxs_pred, \"mean\"]))",
        "> ",
        "pred_ll <- as.data.frame(cbind(coord_pred, model_4_1$summary.fitted.values[idxs_pred, \"0.025quant\"]))",
        "> ",
        "pred_ul <- as.data.frame(cbind(coord_pred, model_4_1$summary.fitted.values[idxs_pred, \"0.975quant\"]))",
        "> ",
        "tt <- \"Posterior Mean\"",
        "> ",
        "coordinates(pred_mm) <- ~ x + y",
        "> ",
        "gridded(pred_mm) <- TRUE",
        "> ",
        "pred_mm <- raster(pred_mm)",
        "> ",
        "crs(pred_mm) <- \"+init=epsg:6345 +units=km +no_defs\"",
        "> ",
        "pred_mm    <- as(pred_mm, \"SpatialPixelsDataFrame\")",
        "> ",
        "pred_mm_df <- as.data.frame(pred_mm)",
        "> ",
        "colnames(pred_mm_df) <- c(\"estimated\", \"x\", \"y\")",
        "> ",
        "pp <- ggplot() +",
        "+ ",
        "  geom_tile(data = pred_mm_df, mapping = aes(x = x, y = y, fill = pred)) + ",
        "+ ",
        "  geom_sf(data = USA, color = \"black\", fill = NA, lwd = 0.5) +",
        "+ ",
        "  scale_fill_gradientn(name = \"PM2.5\", colors = rainbow(9, start = 0.1, end = 0.9)) + ",
        "+ ",
        "  labs(x = \"\", y = \"\", title = tt) + ",
        "+ ",
        "  custom_theme + ",
        "+ ",
        "  theme(axis.text.x = element_blank(),",
        "+ ",
        "        axis.text.y = element_blank(),",
        "+ ",
        "        axis.ticks  = element_blank())",
        "> ",
        "pp",
        "\u001B[1m\u001B[33mError\u001B[39m in `geom_tile()`:\u001B[22m\n\u001B[38;5;232m\u001B[33m!\u001B[38;5;232m Problem while computing aesthetics.\n\u001B[36mℹ\u001B[38;5;232m Error occurred in the 1st layer.\u001B[39m\n\u001B[1mCaused by error:\u001B[22m\n\u001B[33m!\u001B[39m object 'pred' not found\n\u001B[90mRun `\u001B]8;;rstudio:run:rlang::last_trace()\u0007rlang::last_trace()\u001B]8;;\u0007` to see where the error occurred.\u001B[39m\n",
        "> ",
        "pred_mm_df",
        "    estimated         x       y\n1    5.595910 -2249.429 6082.56\n2    5.215142 -2099.429 6082.56\n3    5.655162 -2274.429 6057.56\n4    5.510949 -2249.429 6057.56\n5    5.366744 -2224.429 6057.56\n6    4.947744 -2124.429 6057.56\n7    5.272256 -2099.429 6057.56\n8    5.611635 -2074.429 6057.56\n9    5.951005 -2049.429 6057.56\n10   5.667268 -2274.429 6032.56\n11   5.496093 -2249.429 6032.56\n12   5.324922 -2224.429 6032.56\n13   5.153753 -2199.429 6032.56\n14   4.989950 -2124.429 6032.56\n15   5.329357 -2099.429 6032.56\n",
        "16   5.668741 -2074.429 6032.56\n17   6.008106 -2049.429 6032.56\n18   6.347485 -2024.429 6032.56\n19   5.713327 -2274.429 6007.56\n20   5.542148 -2249.429 6007.56\n21   5.370974 -2224.429 6007.56\n22   5.199800 -2199.429 6007.56\n23   5.028620 -2174.429 6007.56\n24   4.874302 -2149.429 6007.56\n25   5.115627 -2124.429 6007.56\n26   5.389900 -2099.429 6007.56\n27   5.725833 -2074.429 6007.56\n28   6.065200 -2049.429 6007.56\n29   6.404575 -2024.429 6007.56\n30   6.743974 -1999.429 6007.56\n31   7.001850 -1974.429 6007.56\n",
        "32   5.759388 -2274.429 5982.56\n33   5.588199 -2249.429 5982.56\n34   5.417011 -2224.429 5982.56\n35   5.259486 -2199.429 5982.56\n36   5.107467 -2174.429 5982.56\n37   5.073721 -2149.429 5982.56\n38   5.347999 -2124.429 5982.56\n39   5.622266 -2099.429 5982.56\n40   5.896515 -2074.429 5982.56\n41   6.170759 -2049.429 5982.56\n42   6.461668 -2024.429 5982.56\n43   6.801064 -1999.429 5982.56\n44   7.140182 -1974.429 5982.56\n45   7.193585 -1949.429 5982.56\n46   7.155148 -1924.429 5982.56\n47   5.805449 -2274.429 5957.56\n",
        "48   5.644681 -2249.429 5957.56\n49   5.492640 -2224.429 5957.56\n50   5.340618 -2199.429 5957.56\n51   5.188598 -2174.429 5957.56\n52   5.306096 -2149.429 5957.56\n53   5.580369 -2124.429 5957.56\n54   5.854622 -2099.429 5957.56\n55   6.128861 -2074.429 5957.56\n56   6.403113 -2049.429 5957.56\n57   6.677378 -2024.429 5957.56\n58   6.951650 -1999.429 5957.56\n59   7.225924 -1974.429 5957.56\n60   7.243819 -1949.429 5957.56\n61   7.189992 -1924.429 5957.56\n62   7.136169 -1899.429 5957.56\n63   7.082350 -1874.429 5957.56\n",
        "64   5.877865 -2274.429 5932.56\n65   5.725811 -2249.429 5932.56\n66   5.573772 -2224.429 5932.56\n67   5.421754 -2199.429 5932.56\n68   5.269727 -2174.429 5932.56\n69   5.538471 -2149.429 5932.56\n70   5.812730 -2124.429 5932.56\n71   6.086965 -2099.429 5932.56\n72   6.361214 -2074.429 5932.56\n73   6.635483 -2049.429 5932.56\n74   6.909758 -2024.429 5932.56\n75   7.126765 -1999.429 5932.56\n76   7.292121 -1974.429 5932.56\n77   7.270156 -1949.429 5932.56\n78   7.198028 -1924.429 5932.56\n79   7.125902 -1899.429 5932.56\n",
        "80   7.069759 -1874.429 5932.56\n81   7.015939 -1849.429 5932.56\n82   6.962123 -1824.429 5932.56\n83   6.110188 -2299.429 5907.56\n84   5.958997 -2274.429 5907.56\n85   5.806943 -2249.429 5907.56\n86   5.654906 -2224.429 5907.56\n87   5.502891 -2199.429 5907.56\n88   5.496570 -2174.429 5907.56\n89   5.770833 -2149.429 5907.56\n90   6.045071 -2124.429 5907.56\n91   6.319317 -2099.429 5907.56\n92   6.593587 -2074.429 5907.56\n93   6.844883 -2049.429 5907.56\n94   7.010241 -2024.429 5907.56\n95   7.175598 -1999.429 5907.56\n",
        "96   7.340956 -1974.429 5907.56\n97   7.306826 -1949.429 5907.56\n98   7.234698 -1924.429 5907.56\n99   7.162572 -1899.429 5907.56\n100  7.090449 -1874.429 5907.56\n101  7.018327 -1849.429 5907.56\n102  6.949545 -1824.429 5907.56\n103  6.895729 -1799.429 5907.56\n104  6.841913 -1774.429 5907.56\n105  6.788095 -1749.429 5907.56\n106  6.187817 -2299.429 5882.56\n107  6.040125 -2274.429 5882.56\n108  5.888074 -2249.429 5882.56\n109  5.736040 -2224.429 5882.56\n110  5.584021 -2199.429 5882.56\n111  5.728932 -2174.429 5882.56\n",
        "112  6.003176 -2149.429 5882.56\n113  6.277421 -2124.429 5882.56\n114  6.551689 -2099.429 5882.56\n115  6.728354 -2074.429 5882.56\n116  6.893714 -2049.429 5882.56\n117  7.059074 -2024.429 5882.56\n118  7.224434 -1999.429 5882.56\n119  7.389794 -1974.429 5882.56\n120  7.343499 -1949.429 5882.56\n121  7.271372 -1924.429 5882.56\n122  7.199248 -1899.429 5882.56\n123  7.127126 -1874.429 5882.56\n124  7.055008 -1849.429 5882.56\n125  6.982890 -1824.429 5882.56\n126  6.910772 -1799.429 5882.56\n127  6.838652 -1774.429 5882.56\n",
        "128  6.775522 -1749.429 5882.56\n129  6.721704 -1724.429 5882.56\n130  6.667883 -1699.429 5882.56\n131  6.413151 -2324.429 5857.56\n132  6.265451 -2299.429 5857.56\n133  6.117756 -2274.429 5857.56\n134  5.969202 -2249.429 5857.56\n135  5.817169 -2224.429 5857.56\n136  5.687030 -2199.429 5857.56\n137  5.961279 -2174.429 5857.56\n138  6.235526 -2149.429 5857.56\n139  6.446468 -2124.429 5857.56\n140  6.611827 -2099.429 5857.56\n141  6.777189 -2074.429 5857.56\n142  6.942551 -2049.429 5857.56\n143  7.107914 -2024.429 5857.56\n",
        "144  7.273276 -1999.429 5857.56\n145  7.438638 -1974.429 5857.56\n146  7.380179 -1949.429 5857.56\n147  7.308053 -1924.429 5857.56\n148  7.235930 -1899.429 5857.56\n149  7.163810 -1874.429 5857.56\n150  7.091693 -1849.429 5857.56\n151  7.019575 -1824.429 5857.56\n152  6.947457 -1799.429 5857.56\n153  6.875336 -1774.429 5857.56\n154  6.803213 -1749.429 5857.56\n155  6.731090 -1724.429 5857.56\n156  6.658965 -1699.429 5857.56\n157  6.669363 -1674.429 5857.56\n158  6.728972 -1649.429 5857.56\n159  6.490797 -2324.429 5832.56\n",
        "160  6.343095 -2299.429 5832.56\n161  6.195397 -2274.429 5832.56\n162  6.047703 -2249.429 5832.56\n163  5.898291 -2224.429 5832.56\n164  5.919381 -2199.429 5832.56\n165  6.164596 -2174.429 5832.56\n166  6.329955 -2149.429 5832.56\n167  6.495313 -2124.429 5832.56\n168  6.660673 -2099.429 5832.56\n169  6.826035 -2074.429 5832.56\n170  6.991399 -2049.429 5832.56\n171  7.156762 -2024.429 5832.56\n172  7.322125 -1999.429 5832.56\n173  7.487488 -1974.429 5832.56\n174  7.416865 -1949.429 5832.56\n175  7.344740 -1924.429 5832.56\n",
        "176  7.272618 -1899.429 5832.56\n177  7.200498 -1874.429 5832.56\n178  7.128379 -1849.429 5832.56\n179  7.056259 -1824.429 5832.56\n180  6.984138 -1799.429 5832.56\n181  6.912016 -1774.429 5832.56\n182  6.809267 -1749.429 5832.56\n183  6.701421 -1724.429 5832.56\n184  6.616071 -1699.429 5832.56\n185  6.767966 -1674.429 5832.56\n186  6.830019 -1649.429 5832.56\n187  6.892069 -1624.429 5832.56\n188  6.954119 -1599.429 5832.56\n189  7.016174 -1574.429 5832.56\n190  6.685439 -2324.429 5807.56\n191  6.515287 -2299.429 5807.56\n",
        "192  6.345140 -2274.429 5807.56\n193  6.174997 -2249.429 5807.56\n194  6.004856 -2224.429 5807.56\n195  6.048624 -2199.429 5807.56\n196  6.213447 -2174.429 5807.56\n197  6.378806 -2149.429 5807.56\n198  6.544166 -2124.429 5807.56\n199  6.709526 -2099.429 5807.56\n200  6.874889 -2074.429 5807.56\n201  7.040251 -2049.429 5807.56\n202  7.205614 -2024.429 5807.56\n203  7.370977 -1999.429 5807.56\n204  7.525676 -1974.429 5807.56\n205  7.453551 -1949.429 5807.56\n206  7.381427 -1924.429 5807.56\n207  7.309305 -1899.429 5807.56\n",
        "208  7.237183 -1874.429 5807.56\n209  7.151831 -1849.429 5807.56\n210  7.043987 -1824.429 5807.56\n211  6.936144 -1799.429 5807.56\n212  6.828300 -1774.429 5807.56\n213  6.720455 -1749.429 5807.56\n214  6.612607 -1724.429 5807.56\n215  6.683570 -1699.429 5807.56\n216  6.873300 -1674.429 5807.56\n217  6.935349 -1649.429 5807.56\n218  6.997395 -1624.429 5807.56\n219  7.059446 -1599.429 5807.56\n220  7.121506 -1574.429 5807.56\n221  7.183572 -1549.429 5807.56\n222  7.245640 -1524.429 5807.56\n223  7.077432 -2349.429 5782.56\n",
        "224  6.907274 -2324.429 5782.56\n225  6.737119 -2299.429 5782.56\n226  6.566971 -2274.429 5782.56\n227  6.396235 -2249.429 5782.56\n228  6.011240 -2224.429 5782.56\n229  6.076192 -2199.429 5782.56\n230  6.276572 -2174.429 5782.56\n231  6.439397 -2149.429 5782.56\n232  6.602223 -2124.429 5782.56\n233  6.765051 -2099.429 5782.56\n234  6.927881 -2074.429 5782.56\n235  7.090711 -2049.429 5782.56\n236  7.254464 -2024.429 5782.56\n237  7.419827 -1999.429 5782.56\n238  7.562360 -1974.429 5782.56\n239  7.490236 -1949.429 5782.56\n",
        "240  7.386553 -1924.429 5782.56\n241  7.278705 -1899.429 5782.56\n242  7.170858 -1874.429 5782.56\n243  7.063015 -1849.429 5782.56\n244  6.955173 -1824.429 5782.56\n245  6.847331 -1799.429 5782.56\n246  6.739488 -1774.429 5782.56\n247  6.631641 -1749.429 5782.56\n248  6.551250 -1724.429 5782.56\n249  6.751064 -1699.429 5782.56\n250  6.950868 -1674.429 5782.56\n251  7.040681 -1649.429 5782.56\n252  7.102725 -1624.429 5782.56\n253  7.164779 -1599.429 5782.56\n254  7.226845 -1574.429 5782.56\n255  7.288916 -1549.429 5782.56\n",
        "256  7.105189 -1524.429 5782.56\n257  6.865472 -1499.429 5782.56\n258  6.625761 -1474.429 5782.56\n259  6.505137 -1449.429 5782.56\n260  7.299262 -2349.429 5757.56\n261  7.129101 -2324.429 5757.56\n262  6.958946 -2299.429 5757.56\n263  6.760161 -2274.429 5757.56\n264  6.375167 -2249.429 5757.56\n265  5.990175 -2224.429 5757.56\n266  6.033700 -2199.429 5757.56\n267  6.316962 -2174.429 5757.56\n268  6.504522 -2149.429 5757.56\n269  6.667343 -2124.429 5757.56\n270  6.830167 -2099.429 5757.56\n271  6.992994 -2074.429 5757.56\n",
        "272  7.155824 -2049.429 5757.56\n273  7.318655 -2024.429 5757.56\n274  7.481486 -1999.429 5757.56\n275  7.537637 -1974.429 5757.56\n276  7.405583 -1949.429 5757.56\n277  7.297734 -1924.429 5757.56\n278  7.189887 -1899.429 5757.56\n279  7.082042 -1874.429 5757.56\n280  6.974199 -1849.429 5757.56\n281  6.866357 -1824.429 5757.56\n282  6.758514 -1799.429 5757.56\n283  6.650668 -1774.429 5757.56\n284  6.542819 -1749.429 5757.56\n285  6.618750 -1724.429 5757.56\n286  6.818552 -1699.429 5757.56\n287  7.018359 -1674.429 5757.56\n",
        "288  7.146031 -1649.429 5757.56\n289  7.208078 -1624.429 5757.56\n290  7.270134 -1599.429 5757.56\n291  7.332201 -1574.429 5757.56\n292  7.166231 -1549.429 5757.56\n293  6.926508 -1524.429 5757.56\n294  6.686802 -1499.429 5757.56\n295  6.447097 -1474.429 5757.56\n296  6.320394 -1449.429 5757.56\n297  6.237460 -1424.429 5757.56\n298  6.154539 -1399.429 5757.56\n299  7.691252 -2374.429 5732.56\n300  7.521089 -2349.429 5732.56\n301  7.350931 -2324.429 5732.56\n302  7.124092 -2299.429 5732.56\n303  6.739091 -2274.429 5732.56\n",
        "304  6.354104 -2249.429 5732.56\n305  5.969099 -2224.429 5732.56\n306  5.991202 -2199.429 5732.56\n307  6.274461 -2174.429 5732.56\n308  6.557742 -2149.429 5732.56\n309  6.732480 -2124.429 5732.56\n310  6.895298 -2099.429 5732.56\n311  7.058117 -2074.429 5732.56\n312  7.220941 -2049.429 5732.56\n313  7.383769 -2024.429 5732.56\n314  7.546599 -1999.429 5732.56\n315  7.493581 -1974.429 5732.56\n316  7.342971 -1949.429 5732.56\n317  7.208915 -1924.429 5732.56\n318  7.101068 -1899.429 5732.56\n319  6.993223 -1874.429 5732.56\n",
        "320  6.885378 -1849.429 5732.56\n321  6.777533 -1824.429 5732.56\n322  6.669687 -1799.429 5732.56\n323  6.561838 -1774.429 5732.56\n324  6.486408 -1749.429 5732.56\n325  6.686241 -1724.429 5732.56\n326  6.886035 -1699.429 5732.56\n327  7.085857 -1674.429 5732.56\n328  7.251401 -1649.429 5732.56\n329  7.313453 -1624.429 5732.56\n330  7.375510 -1599.429 5732.56\n331  7.227296 -1574.429 5732.56\n332  6.987557 -1549.429 5732.56\n333  6.747846 -1524.429 5732.56\n [ reached 'max' / getOption(\"max.print\") -- omitted 13349 rows ",
        "]\n",
        "> ",
        "pred_mm <- as.data.frame(cbind(coord_pred, model_4_1$summary.fitted.values[idxs_pred, \"mean\"]))",
        "> ",
        "pred_ll <- as.data.frame(cbind(coord_pred, model_4_1$summary.fitted.values[idxs_pred, \"0.025quant\"]))",
        "> ",
        "pred_ul <- as.data.frame(cbind(coord_pred, model_4_1$summary.fitted.values[idxs_pred, \"0.975quant\"]))",
        "> ",
        "tt <- \"Posterior Mean\"",
        "> ",
        "coordinates(pred_mm) <- ~ x + y",
        "> ",
        "gridded(pred_mm) <- TRUE",
        "> ",
        "pred_mm <- raster(pred_mm)",
        "> ",
        "crs(pred_mm) <- \"+init=epsg:6345 +units=km +no_defs\"",
        "> ",
        "pred_mm    <- as(pred_mm, \"SpatialPixelsDataFrame\")",
        "> ",
        "pred_mm_df <- as.data.frame(pred_mm)",
        "> ",
        "colnames(pred_mm_df) <- c(\"pred\", \"x\", \"y\")",
        "> ",
        "pp <- ggplot() +",
        "+ ",
        "  geom_tile(data = pred_mm_df, mapping = aes(x = x, y = y, fill = pred)) + ",
        "+ ",
        "  geom_sf(data = USA, color = \"black\", fill = NA, lwd = 0.5) +",
        "+ ",
        "  scale_fill_gradientn(name = \"PM2.5\", colors = rainbow(9, start = 0.1, end = 0.9)) + ",
        "+ ",
        "  labs(x = \"\", y = \"\", title = tt) + ",
        "+ ",
        "  custom_theme + ",
        "+ ",
        "  theme(axis.text.x = element_blank(),",
        "+ ",
        "        axis.text.y = element_blank(),",
        "+ ",
        "        axis.ticks  = element_blank())",
        "> ",
        "pp",
        "> ",
        "pred_mm",
        "Object of class SpatialPixelsDataFrame\nObject of class SpatialPixels\nGrid topology:\n   cellcentre.offset cellsize cells.dim\ns1         -2699.429       25       192\ns2          2732.560       25       135\nSpatialPoints:\n                     x       y\n    [1,] -2249.4293796 6082.56\n    [2,] -2099.4293796 6082.56\n    [3,] -2274.4293796 6057.56\n    [4,] -2249.4293796 6057.56\n    [5,] -2224.4293796 6057.56\n    [6,] -2124.4293796 6057.56\n    [7,] -2099.4293796 6057.56\n    [8,] -2074.4293796 6057.56\n    [9,] -2049",
        ".4293796 6057.56\n   [10,] -2274.4293796 6032.56\n   [11,] -2249.4293796 6032.56\n   [12,] -2224.4293796 6032.56\n   [13,] -2199.4293796 6032.56\n   [14,] -2124.4293796 6032.56\n   [15,] -2099.4293796 6032.56\n   [16,] -2074.4293796 6032.56\n   [17,] -2049.4293796 6032.56\n   [18,] -2024.4293796 6032.56\n   [19,] -2274.4293796 6007.56\n   [20,] -2249.4293796 6007.56\n   [21,] -2224.4293796 6007.56\n   [22,] -2199.4293796 6007.56\n   [23,] -2174.4293796 6007.56\n   [24,] -2149.4293796 6007.56\n   [25,] -2124.4293796 6007.56",
        "\n   [26,] -2099.4293796 6007.56\n   [27,] -2074.4293796 6007.56\n   [28,] -2049.4293796 6007.56\n   [29,] -2024.4293796 6007.56\n   [30,] -1999.4293796 6007.56\n   [31,] -1974.4293796 6007.56\n   [32,] -2274.4293796 5982.56\n   [33,] -2249.4293796 5982.56\n   [34,] -2224.4293796 5982.56\n   [35,] -2199.4293796 5982.56\n   [36,] -2174.4293796 5982.56\n   [37,] -2149.4293796 5982.56\n   [38,] -2124.4293796 5982.56\n   [39,] -2099.4293796 5982.56\n   [40,] -2074.4293796 5982.56\n   [41,] -2049.4293796 5982.56\n   [42,] -2024.",
        "4293796 5982.56\n   [43,] -1999.4293796 5982.56\n   [44,] -1974.4293796 5982.56\n   [45,] -1949.4293796 5982.56\n   [46,] -1924.4293796 5982.56\n   [47,] -2274.4293796 5957.56\n   [48,] -2249.4293796 5957.56\n   [49,] -2224.4293796 5957.56\n   [50,] -2199.4293796 5957.56\n   [51,] -2174.4293796 5957.56\n   [52,] -2149.4293796 5957.56\n   [53,] -2124.4293796 5957.56\n   [54,] -2099.4293796 5957.56\n   [55,] -2074.4293796 5957.56\n   [56,] -2049.4293796 5957.56\n   [57,] -2024.4293796 5957.56\n   [58,] -1999.4293796 5957.56\n",
        "   [59,] -1974.4293796 5957.56\n   [60,] -1949.4293796 5957.56\n   [61,] -1924.4293796 5957.56\n   [62,] -1899.4293796 5957.56\n   [63,] -1874.4293796 5957.56\n   [64,] -2274.4293796 5932.56\n   [65,] -2249.4293796 5932.56\n   [66,] -2224.4293796 5932.56\n   [67,] -2199.4293796 5932.56\n   [68,] -2174.4293796 5932.56\n   [69,] -2149.4293796 5932.56\n   [70,] -2124.4293796 5932.56\n   [71,] -2099.4293796 5932.56\n   [72,] -2074.4293796 5932.56\n   [73,] -2049.4293796 5932.56\n   [74,] -2024.4293796 5932.56\n   [75,] -1999.4",
        "293796 5932.56\n   [76,] -1974.4293796 5932.56\n   [77,] -1949.4293796 5932.56\n   [78,] -1924.4293796 5932.56\n   [79,] -1899.4293796 5932.56\n   [80,] -1874.4293796 5932.56\n   [81,] -1849.4293796 5932.56\n   [82,] -1824.4293796 5932.56\n   [83,] -2299.4293796 5907.56\n   [84,] -2274.4293796 5907.56\n   [85,] -2249.4293796 5907.56\n   [86,] -2224.4293796 5907.56\n   [87,] -2199.4293796 5907.56\n   [88,] -2174.4293796 5907.56\n   [89,] -2149.4293796 5907.56\n   [90,] -2124.4293796 5907.56\n   [91,] -2099.4293796 5907.56\n ",
        "  [92,] -2074.4293796 5907.56\n   [93,] -2049.4293796 5907.56\n   [94,] -2024.4293796 5907.56\n   [95,] -1999.4293796 5907.56\n   [96,] -1974.4293796 5907.56\n   [97,] -1949.4293796 5907.56\n   [98,] -1924.4293796 5907.56\n   [99,] -1899.4293796 5907.56\n  [100,] -1874.4293796 5907.56\n  [101,] -1849.4293796 5907.56\n  [102,] -1824.4293796 5907.56\n  [103,] -1799.4293796 5907.56\n  [104,] -1774.4293796 5907.56\n  [105,] -1749.4293796 5907.56\n  [106,] -2299.4293796 5882.56\n  [107,] -2274.4293796 5882.56\n  [108,] -2249.42",
        "93796 5882.56\n  [109,] -2224.4293796 5882.56\n  [110,] -2199.4293796 5882.56\n  [111,] -2174.4293796 5882.56\n  [112,] -2149.4293796 5882.56\n  [113,] -2124.4293796 5882.56\n  [114,] -2099.4293796 5882.56\n  [115,] -2074.4293796 5882.56\n  [116,] -2049.4293796 5882.56\n  [117,] -2024.4293796 5882.56\n  [118,] -1999.4293796 5882.56\n  [119,] -1974.4293796 5882.56\n  [120,] -1949.4293796 5882.56\n  [121,] -1924.4293796 5882.56\n  [122,] -1899.4293796 5882.56\n  [123,] -1874.4293796 5882.56\n  [124,] -1849.4293796 5882.56\n  ",
        "[125,] -1824.4293796 5882.56\n  [126,] -1799.4293796 5882.56\n  [127,] -1774.4293796 5882.56\n  [128,] -1749.4293796 5882.56\n  [129,] -1724.4293796 5882.56\n  [130,] -1699.4293796 5882.56\n  [131,] -2324.4293796 5857.56\n  [132,] -2299.4293796 5857.56\n  [133,] -2274.4293796 5857.56\n  [134,] -2249.4293796 5857.56\n  [135,] -2224.4293796 5857.56\n  [136,] -2199.4293796 5857.56\n  [137,] -2174.4293796 5857.56\n  [138,] -2149.4293796 5857.56\n  [139,] -2124.4293796 5857.56\n  [140,] -2099.4293796 5857.56\n  [141,] -2074.429",
        "3796 5857.56\n  [142,] -2049.4293796 5857.56\n  [143,] -2024.4293796 5857.56\n  [144,] -1999.4293796 5857.56\n  [145,] -1974.4293796 5857.56\n  [146,] -1949.4293796 5857.56\n  [147,] -1924.4293796 5857.56\n  [148,] -1899.4293796 5857.56\n  [149,] -1874.4293796 5857.56\n  [150,] -1849.4293796 5857.56\n  [151,] -1824.4293796 5857.56\n  [152,] -1799.4293796 5857.56\n  [153,] -1774.4293796 5857.56\n  [154,] -1749.4293796 5857.56\n  [155,] -1724.4293796 5857.56\n  [156,] -1699.4293796 5857.56\n  [157,] -1674.4293796 5857.56\n  [",
        "158,] -1649.4293796 5857.56\n  [159,] -2324.4293796 5832.56\n  [160,] -2299.4293796 5832.56\n  [161,] -2274.4293796 5832.56\n  [162,] -2249.4293796 5832.56\n  [163,] -2224.4293796 5832.56\n  [164,] -2199.4293796 5832.56\n  [165,] -2174.4293796 5832.56\n  [166,] -2149.4293796 5832.56\n  [167,] -2124.4293796 5832.56\n  [168,] -2099.4293796 5832.56\n  [169,] -2074.4293796 5832.56\n  [170,] -2049.4293796 5832.56\n  [171,] -2024.4293796 5832.56\n  [172,] -1999.4293796 5832.56\n  [173,] -1974.4293796 5832.56\n  [174,] -1949.4293",
        "796 5832.56\n  [175,] -1924.4293796 5832.56\n  [176,] -1899.4293796 5832.56\n  [177,] -1874.4293796 5832.56\n  [178,] -1849.4293796 5832.56\n  [179,] -1824.4293796 5832.56\n  [180,] -1799.4293796 5832.56\n  [181,] -1774.4293796 5832.56\n  [182,] -1749.4293796 5832.56\n  [183,] -1724.4293796 5832.56\n  [184,] -1699.4293796 5832.56\n  [185,] -1674.4293796 5832.56\n  [186,] -1649.4293796 5832.56\n  [187,] -1624.4293796 5832.56\n  [188,] -1599.4293796 5832.56\n  [189,] -1574.4293796 5832.56\n  [190,] -2324.4293796 5807.56\n  [1",
        "91,] -2299.4293796 5807.56\n  [192,] -2274.4293796 5807.56\n  [193,] -2249.4293796 5807.56\n  [194,] -2224.4293796 5807.56\n  [195,] -2199.4293796 5807.56\n  [196,] -2174.4293796 5807.56\n  [197,] -2149.4293796 5807.56\n  [198,] -2124.4293796 5807.56\n  [199,] -2099.4293796 5807.56\n  [200,] -2074.4293796 5807.56\n  [201,] -2049.4293796 5807.56\n  [202,] -2024.4293796 5807.56\n  [203,] -1999.4293796 5807.56\n  [204,] -1974.4293796 5807.56\n  [205,] -1949.4293796 5807.56\n  [206,] -1924.4293796 5807.56\n  [207,] -1899.42937",
        "96 5807.56\n  [208,] -1874.4293796 5807.56\n  [209,] -1849.4293796 5807.56\n  [210,] -1824.4293796 5807.56\n  [211,] -1799.4293796 5807.56\n  [212,] -1774.4293796 5807.56\n  [213,] -1749.4293796 5807.56\n  [214,] -1724.4293796 5807.56\n  [215,] -1699.4293796 5807.56\n  [216,] -1674.4293796 5807.56\n  [217,] -1649.4293796 5807.56\n  [218,] -1624.4293796 5807.56\n  [219,] -1599.4293796 5807.56\n  [220,] -1574.4293796 5807.56\n  [221,] -1549.4293796 5807.56\n  [222,] -1524.4293796 5807.56\n  [223,] -2349.4293796 5782.56\n  [22",
        "4,] -2324.4293796 5782.56\n  [225,] -2299.4293796 5782.56\n  [226,] -2274.4293796 5782.56\n  [227,] -2249.4293796 5782.56\n  [228,] -2224.4293796 5782.56\n  [229,] -2199.4293796 5782.56\n  [230,] -2174.4293796 5782.56\n  [231,] -2149.4293796 5782.56\n  [232,] -2124.4293796 5782.56\n  [233,] -2099.4293796 5782.56\n  [234,] -2074.4293796 5782.56\n  [235,] -2049.4293796 5782.56\n  [236,] -2024.4293796 5782.56\n  [237,] -1999.4293796 5782.56\n  [238,] -1974.4293796 5782.56\n  [239,] -1949.4293796 5782.56\n  [240,] -1924.429379",
        "6 5782.56\n  [241,] -1899.4293796 5782.56\n  [242,] -1874.4293796 5782.56\n  [243,] -1849.4293796 5782.56\n  [244,] -1824.4293796 5782.56\n  [245,] -1799.4293796 5782.56\n  [246,] -1774.4293796 5782.56\n  [247,] -1749.4293796 5782.56\n  [248,] -1724.4293796 5782.56\n  [249,] -1699.4293796 5782.56\n  [250,] -1674.4293796 5782.56\n  [251,] -1649.4293796 5782.56\n  [252,] -1624.4293796 5782.56\n  [253,] -1599.4293796 5782.56\n  [254,] -1574.4293796 5782.56\n  [255,] -1549.4293796 5782.56\n  [256,] -1524.4293796 5782.56\n  [257",
        ",] -1499.4293796 5782.56\n  [258,] -1474.4293796 5782.56\n  [259,] -1449.4293796 5782.56\n  [260,] -2349.4293796 5757.56\n  [261,] -2324.4293796 5757.56\n  [262,] -2299.4293796 5757.56\n  [263,] -2274.4293796 5757.56\n  [264,] -2249.4293796 5757.56\n  [265,] -2224.4293796 5757.56\n  [266,] -2199.4293796 5757.56\n  [267,] -2174.4293796 5757.56\n  [268,] -2149.4293796 5757.56\n  [269,] -2124.4293796 5757.56\n  [270,] -2099.4293796 5757.56\n  [271,] -2074.4293796 5757.56\n  [272,] -2049.4293796 5757.56\n  [273,] -2024.4293796",
        " 5757.56\n  [274,] -1999.4293796 5757.56\n  [275,] -1974.4293796 5757.56\n  [276,] -1949.4293796 5757.56\n  [277,] -1924.4293796 5757.56\n  [278,] -1899.4293796 5757.56\n  [279,] -1874.4293796 5757.56\n  [280,] -1849.4293796 5757.56\n  [281,] -1824.4293796 5757.56\n  [282,] -1799.4293796 5757.56\n  [283,] -1774.4293796 5757.56\n  [284,] -1749.4293796 5757.56\n  [285,] -1724.4293796 5757.56\n  [286,] -1699.4293796 5757.56\n  [287,] -1674.4293796 5757.56\n  [288,] -1649.4293796 5757.56\n  [289,] -1624.4293796 5757.56\n  [290,",
        "] -1599.4293796 5757.56\n  [291,] -1574.4293796 5757.56\n  [292,] -1549.4293796 5757.56\n  [293,] -1524.4293796 5757.56\n  [294,] -1499.4293796 5757.56\n  [295,] -1474.4293796 5757.56\n  [296,] -1449.4293796 5757.56\n  [297,] -1424.4293796 5757.56\n  [298,] -1399.4293796 5757.56\n  [299,] -2374.4293796 5732.56\n  [300,] -2349.4293796 5732.56\n  [301,] -2324.4293796 5732.56\n  [302,] -2299.4293796 5732.56\n  [303,] -2274.4293796 5732.56\n  [304,] -2249.4293796 5732.56\n  [305,] -2224.4293796 5732.56\n  [306,] -2199.4293796 ",
        "5732.56\n  [307,] -2174.4293796 5732.56\n  [308,] -2149.4293796 5732.56\n  [309,] -2124.4293796 5732.56\n  [310,] -2099.4293796 5732.56\n  [311,] -2074.4293796 5732.56\n  [312,] -2049.4293796 5732.56\n  [313,] -2024.4293796 5732.56\n  [314,] -1999.4293796 5732.56\n  [315,] -1974.4293796 5732.56\n  [316,] -1949.4293796 5732.56\n  [317,] -1924.4293796 5732.56\n  [318,] -1899.4293796 5732.56\n  [319,] -1874.4293796 5732.56\n  [320,] -1849.4293796 5732.56\n  [321,] -1824.4293796 5732.56\n  [322,] -1799.4293796 5732.56\n  [323,]",
        " -1774.4293796 5732.56\n  [324,] -1749.4293796 5732.56\n  [325,] -1724.4293796 5732.56\n  [326,] -1699.4293796 5732.56\n  [327,] -1674.4293796 5732.56\n  [328,] -1649.4293796 5732.56\n  [329,] -1624.4293796 5732.56\n  [330,] -1599.4293796 5732.56\n  [331,] -1574.4293796 5732.56\n  [332,] -1549.4293796 5732.56\n  [333,] -1524.4293796 5732.56\n  [334,] -1499.4293796 5732.56\n  [335,] -1474.4293796 5732.56\n  [336,] -1449.4293796 5732.56\n  [337,] -1424.4293796 5732.56\n  [338,] -1399.4293796 5732.56\n  [339,] -1374.4293796 5",
        "732.56\n  [340,] -1349.4293796 5732.56\n  [341,] -1324.4293796 5732.56\n  [342,] -2399.4293796 5707.56\n  [343,] -2374.4293796 5707.56\n  [344,] -2349.4293796 5707.56\n  [345,] -2324.4293796 5707.56\n  [346,] -2299.4293796 5707.56\n  [347,] -2274.4293796 5707.56\n  [348,] -2249.4293796 5707.56\n  [349,] -2224.4293796 5707.56\n  [350,] -2199.4293796 5707.56\n  [351,] -2174.4293796 5707.56\n  [352,] -2149.4293796 5707.56\n  [353,] -2124.4293796 5707.56\n  [354,] -2099.4293796 5707.56\n  [355,] -2074.4293796 5707.56\n  [356,] ",
        "-2049.4293796 5707.56\n  [357,] -2024.4293796 5707.56\n  [358,] -1999.4293796 5707.56\n  [359,] -1974.4293796 5707.56\n  [360,] -1949.4293796 5707.56\n  [361,] -1924.4293796 5707.56\n  [362,] -1899.4293796 5707.56\n  [363,] -1874.4293796 5707.56\n  [364,] -1849.4293796 5707.56\n  [365,] -1824.4293796 5707.56\n  [366,] -1799.4293796 5707.56\n  [367,] -1774.4293796 5707.56\n  [368,] -1749.4293796 5707.56\n  [369,] -1724.4293796 5707.56\n  [370,] -1699.4293796 5707.56\n  [371,] -1674.4293796 5707.56\n  [372,] -1649.4293796 57",
        "07.56\n  [373,] -1624.4293796 5707.56\n  [374,] -1599.4293796 5707.56\n  [375,] -1574.4293796 5707.56\n  [376,] -1549.4293796 5707.56\n  [377,] -1524.4293796 5707.56\n  [378,] -1499.4293796 5707.56\n  [379,] -1474.4293796 5707.56\n  [380,] -1449.4293796 5707.56\n  [381,] -1424.4293796 5707.56\n  [382,] -1399.4293796 5707.56\n  [383,] -1374.4293796 5707.56\n  [384,] -1349.4293796 5707.56\n  [385,] -1324.4293796 5707.56\n  [386,] -1299.4293796 5707.56\n  [387,] -1274.4293796 5707.56\n  [388,] -1249.4293796 5707.56\n  [389,] -",
        "2399.4293796 5682.56\n  [390,] -2374.4293796 5682.56\n  [391,] -2349.4293796 5682.56\n  [392,] -2324.4293796 5682.56\n  [393,] -2299.4293796 5682.56\n  [394,] -2274.4293796 5682.56\n  [395,] -2249.4293796 5682.56\n  [396,] -2224.4293796 5682.56\n  [397,] -2199.4293796 5682.56\n  [398,] -2174.4293796 5682.56\n  [399,] -2149.4293796 5682.56\n  [400,] -2124.4293796 5682.56\n  [401,] -2099.4293796 5682.56\n  [402,] -2074.4293796 5682.56\n  [403,] -2049.4293796 5682.56\n  [404,] -2024.4293796 5682.56\n  [405,] -1999.4293796 568",
        "2.56\n  [406,] -1974.4293796 5682.56\n  [407,] -1949.4293796 5682.56\n  [408,] -1924.4293796 5682.56\n  [409,] -1899.4293796 5682.56\n  [410,] -1874.4293796 5682.56\n  [411,] -1849.4293796 5682.56\n  [412,] -1824.4293796 5682.56\n  [413,] -1799.4293796 5682.56\n  [414,] -1774.4293796 5682.56\n  [415,] -1749.4293796 5682.56\n  [416,] -1724.4293796 5682.56\n  [417,] -1699.4293796 5682.56\n  [418,] -1674.4293796 5682.56\n  [419,] -1649.4293796 5682.56\n  [420,] -1624.4293796 5682.56\n  [421,] -1599.4293796 5682.56\n  [422,] -1",
        "574.4293796 5682.56\n  [423,] -1549.4293796 5682.56\n  [424,] -1524.4293796 5682.56\n  [425,] -1499.4293796 5682.56\n  [426,] -1474.4293796 5682.56\n  [427,] -1449.4293796 5682.56\n  [428,] -1424.4293796 5682.56\n  [429,] -1399.4293796 5682.56\n  [430,] -1374.4293796 5682.56\n  [431,] -1349.4293796 5682.56\n  [432,] -1324.4293796 5682.56\n  [433,] -1299.4293796 5682.56\n  [434,] -1274.4293796 5682.56\n  [435,] -1249.4293796 5682.56\n  [436,] -1224.4293796 5682.56\n  [437,] -1199.4293796 5682.56\n  [438,] -1174.4293796 5682",
        ".56\n  [439,] -2424.4293796 5657.56\n  [440,] -2399.4293796 5657.56\n  [441,] -2374.4293796 5657.56\n  [442,] -2349.4293796 5657.56\n  [443,] -2324.4293796 5657.56\n  [444,] -2299.4293796 5657.56\n  [445,] -2274.4293796 5657.56\n  [446,] -2249.4293796 5657.56\n  [447,] -2224.4293796 5657.56\n  [448,] -2199.4293796 5657.56\n  [449,] -2174.4293796 5657.56\n  [450,] -2149.4293796 5657.56\n  [451,] -2124.4293796 5657.56\n  [452,] -2099.4293796 5657.56\n  [453,] -2074.4293796 5657.56\n  [454,] -2049.4293796 5657.56\n  [455,] -20",
        "24.4293796 5657.56\n  [456,] -1999.4293796 5657.56\n  [457,] -1974.4293796 5657.56\n  [458,] -1949.4293796 5657.56\n  [459,] -1924.4293796 5657.56\n  [460,] -1899.4293796 5657.56\n  [461,] -1874.4293796 5657.56\n  [462,] -1849.4293796 5657.56\n  [463,] -1824.4293796 5657.56\n  [464,] -1799.4293796 5657.56\n  [465,] -1774.4293796 5657.56\n  [466,] -1749.4293796 5657.56\n  [467,] -1724.4293796 5657.56\n  [468,] -1699.4293796 5657.56\n  [469,] -1674.4293796 5657.56\n  [470,] -1649.4293796 5657.56\n  [471,] -1624.4293796 5657.",
        "56\n  [472,] -1599.4293796 5657.56\n  [473,] -1574.4293796 5657.56\n  [474,] -1549.4293796 5657.56\n  [475,] -1524.4293796 5657.56\n  [476,] -1499.4293796 5657.56\n  [477,] -1474.4293796 5657.56\n  [478,] -1449.4293796 5657.56\n  [479,] -1424.4293796 5657.56\n  [480,] -1399.4293796 5657.56\n  [481,] -1374.4293796 5657.56\n  [482,] -1349.4293796 5657.56\n  [483,] -1324.4293796 5657.56\n  [484,] -1299.4293796 5657.56\n  [485,] -1274.4293796 5657.56\n  [486,] -1249.4293796 5657.56\n  [487,] -1224.4293796 5657.56\n  [488,] -119",
        "9.4293796 5657.56\n  [489,] -1174.4293796 5657.56\n  [490,] -1149.4293796 5657.56\n  [491,] -1124.4293796 5657.56\n  [492,] -1099.4293796 5657.56\n  [493,] -2449.4293796 5632.56\n  [494,] -2424.4293796 5632.56\n  [495,] -2399.4293796 5632.56\n  [496,] -2374.4293796 5632.56\n  [497,] -2349.4293796 5632.56\n  [498,] -2324.4293796 5632.56\n  [499,] -2299.4293796 5632.56\n  [500,] -2274.4293796 5632.56\n [ reached getOption(\"max.print\") -- omitted 13182 rows ]\nCoordinate Reference System (CRS) arguments: +proj=utm +zone=16 ",
        "+ellps=GRS80\n+units=km +no_defs \n\nData summary:\n       V3        \n Min.   : 2.116  \n 1st Qu.: 5.704  \n Median : 6.736  \n Mean   : 6.766  \n 3rd Qu.: 7.869  \n Max.   :15.002  \n",
        "> ",
        "pred_mm$V3",
        "   [1] 5.595910 5.215142 5.655162 5.510949 5.366744 4.947744 5.272256 5.611635 5.951005\n  [10] 5.667268 5.496093 5.324922 5.153753 4.989950 5.329357 5.668741 6.008106 6.347485\n  [19] 5.713327 5.542148 5.370974 5.199800 5.028620 4.874302 5.115627 5.389900 5.725833\n  [28] 6.065200 6.404575 6.743974 7.001850 5.759388 5.588199 5.417011 5.259486 5.107467\n  [37] 5.073721 5.347999 5.622266 5.896515 6.170759 6.461668 6.801064 7.140182 7.193585\n  [46] 7.155148 5.805449 5.644681 5.492640 5.340618 5.188598 5.306096 5.",
        "580369 5.854622\n  [55] 6.128861 6.403113 6.677378 6.951650 7.225924 7.243819 7.189992 7.136169 7.082350\n  [64] 5.877865 5.725811 5.573772 5.421754 5.269727 5.538471 5.812730 6.086965 6.361214\n  [73] 6.635483 6.909758 7.126765 7.292121 7.270156 7.198028 7.125902 7.069759 7.015939\n  [82] 6.962123 6.110188 5.958997 5.806943 5.654906 5.502891 5.496570 5.770833 6.045071\n  [91] 6.319317 6.593587 6.844883 7.010241 7.175598 7.340956 7.306826 7.234698 7.162572\n [100] 7.090449 7.018327 6.949545 6.895729 6.841913 6.78",
        "8095 6.187817 6.040125 5.888074\n [109] 5.736040 5.584021 5.728932 6.003176 6.277421 6.551689 6.728354 6.893714 7.059074\n [118] 7.224434 7.389794 7.343499 7.271372 7.199248 7.127126 7.055008 6.982890 6.910772\n [127] 6.838652 6.775522 6.721704 6.667883 6.413151 6.265451 6.117756 5.969202 5.817169\n [136] 5.687030 5.961279 6.235526 6.446468 6.611827 6.777189 6.942551 7.107914 7.273276\n [145] 7.438638 7.380179 7.308053 7.235930 7.163810 7.091693 7.019575 6.947457 6.875336\n [154] 6.803213 6.731090 6.658965 6.6693",
        "63 6.728972 6.490797 6.343095 6.195397 6.047703\n [163] 5.898291 5.919381 6.164596 6.329955 6.495313 6.660673 6.826035 6.991399 7.156762\n [172] 7.322125 7.487488 7.416865 7.344740 7.272618 7.200498 7.128379 7.056259 6.984138\n [181] 6.912016 6.809267 6.701421 6.616071 6.767966 6.830019 6.892069 6.954119 7.016174\n [190] 6.685439 6.515287 6.345140 6.174997 6.004856 6.048624 6.213447 6.378806 6.544166\n [199] 6.709526 6.874889 7.040251 7.205614 7.370977 7.525676 7.453551 7.381427 7.309305\n [208] 7.237183 7.151831",
        " 7.043987 6.936144 6.828300 6.720455 6.612607 6.683570 6.873300\n [217] 6.935349 6.997395 7.059446 7.121506 7.183572 7.245640 7.077432 6.907274 6.737119\n [226] 6.566971 6.396235 6.011240 6.076192 6.276572 6.439397 6.602223 6.765051 6.927881\n [235] 7.090711 7.254464 7.419827 7.562360 7.490236 7.386553 7.278705 7.170858 7.063015\n [244] 6.955173 6.847331 6.739488 6.631641 6.551250 6.751064 6.950868 7.040681 7.102725\n [253] 7.164779 7.226845 7.288916 7.105189 6.865472 6.625761 6.505137 7.299262 7.129101\n [262] 6",
        ".958946 6.760161 6.375167 5.990175 6.033700 6.316962 6.504522 6.667343 6.830167\n [271] 6.992994 7.155824 7.318655 7.481486 7.537637 7.405583 7.297734 7.189887 7.082042\n [280] 6.974199 6.866357 6.758514 6.650668 6.542819 6.618750 6.818552 7.018359 7.146031\n [289] 7.208078 7.270134 7.332201 7.166231 6.926508 6.686802 6.447097 6.320394 6.237460\n [298] 6.154539 7.691252 7.521089 7.350931 7.124092 6.739091 6.354104 5.969099 5.991202\n [307] 6.274461 6.557742 6.732480 6.895298 7.058117 7.220941 7.383769 7.546599 7",
        ".493581\n [316] 7.342971 7.208915 7.101068 6.993223 6.885378 6.777533 6.669687 6.561838 6.486408\n [325] 6.686241 6.886035 7.085857 7.251401 7.313453 7.375510 7.227296 6.987557 6.747846\n [334] 6.508146 6.268441 6.135661 6.052722 5.969796 5.886883 5.804337 5.723697 8.083241\n [343] 7.913081 7.742925 7.488033 7.103018 6.718025 6.333028 5.948005 5.948688 6.231959\n [352] 6.515231 6.797626 6.960444 7.123260 7.286076 7.448895 7.600138 7.449528 7.298922\n [361] 7.148308 7.012248 6.904400 6.796552 6.688704 6.580854 6.4",
        "73003 6.553904 6.753725\n [370] 6.953523 7.153362 7.353242 7.418836 7.288390 7.048641 6.808914 6.569206 6.329502\n [379] 6.089790 5.950932 5.867994 5.785062 5.702142 5.619232 5.536860 5.456222 5.396508\n [388] 5.351225 8.305074 8.134921 7.851979 7.466954 7.081947 6.696947 6.311931 5.926896\n [397] 5.906158 6.189447 6.472722 6.756013 7.025592 7.188409 7.351223 7.514037 7.556101\n [406] 7.405483 7.254874 7.104264 6.953642 6.815575 6.707724 6.599873 6.492021 6.421548\n [415] 6.621395 6.821208 7.021020 7.220873 7.420",
        "757 7.349487 7.109743 6.870009 6.630288\n [424] 6.390574 6.150858 5.911136 5.766200 5.683266 5.600332 5.517406 5.434490 5.351579\n [433] 5.270732 5.225452 5.180173 5.134904 5.089656 5.044430 8.697066 8.526917 8.215924\n [442] 7.830896 7.445878 7.060868 6.675853 6.290823 5.905784 5.863622 6.146926 6.430210\n [451] 6.713497 6.996800 7.253557 7.416372 7.579185 7.512071 7.361446 7.210829 7.060215\n [460] 6.909595 6.758967 6.618895 6.511042 6.403189 6.489049 6.688884 6.888699 7.081016\n [469] 7.120923 7.160842 7.13351",
        "5 6.904120 6.674741 6.445372 6.211933 5.972207 5.732476\n [478] 5.581463 5.498534 5.415601 5.312949 5.205153 5.097365 5.075994 5.057766 5.011450\n [487] 4.965145 4.918856 4.873370 4.828145 4.845977 4.909908 8.925625 8.918911 8.579867\n [496] 8.194838 7.809815 7.424797 7.039779 6.654751 6.269715 5.884674 5.821086 6.104400\n [505] 6.387695 6.670983 6.954279 7.237589 7.481519 7.618679 7.468042 7.317411 7.166786\n [514] 7.016165 6.865543 6.714917 6.564285 6.422212 6.356697 6.556546 6.647111 6.687002\n [523] 6.726889 ",
        "6.766777 6.806677 6.846590 6.676314 6.446932 6.217565 5.988193 5.758811\n [532] 5.529422 5.337621 5.229824 5.122018 5.014213 4.906415 4.798627 4.856023 4.892390\n [541] 4.846073 4.799765 4.753477 4.707205 4.660938 4.706285 4.764536 4.828383 4.892229\n [550] 4.956074 5.019924 8.882863 8.968500 8.574842 8.181189 7.788732 7.403710 7.018683\n [559] 6.633649 6.248610 5.863568 5.778553 6.061873 6.345176 6.628469 6.911762 7.195065\n [568] 7.478377 7.574400 7.423069 7.271743 7.120421 6.969104 6.817790 6.666474 6.515154\n",
        " [577] 6.363829 6.286325 6.253065 6.292972 6.332877 6.372775 6.412664 6.452548 6.492439\n [586] 6.448527 6.219146 5.989777 5.760402 5.531015 5.308130 5.085988 4.931093 4.823295\n [595] 4.715489 4.607688 4.560324 4.636056 4.711796 4.680702 4.634394 4.588106 4.541833\n [604] 4.537012 4.586029 4.635050 4.684073 4.746862 4.810713 4.874567 4.938424 5.002285\n [613] 5.066148 8.491611 8.601637 8.711663 8.610038 8.216396 7.822762 7.429123 7.035464\n [622] 6.641790 6.248111 5.854431 5.740791 6.027498 6.314189 6.600866 6.",
        "887539 7.174221\n [631] 7.460916 7.510983 7.359654 7.208330 7.057012 6.905698 6.754385 6.603068 6.451746\n [640] 6.395861 6.384975 6.297104 6.160186 6.023268 6.018635 6.058542 6.098438 6.138324\n [649] 6.178210 5.991381 5.762011 5.532627 5.309510 5.087365 4.865222 4.643080 4.524585\n [658] 4.416783 4.308976 4.340374 4.416101 4.491836 4.515339 4.469034 4.422745 4.376469\n [667] 4.416765 4.465784 4.514806 4.563832 4.612861 4.665361 4.729217 4.793073 4.856929\n [676] 4.932727 5.038347 5.143973 5.249613 5.340596 8.10",
        "0374 8.210402 8.320423 8.430440\n [685] 8.540464 8.251598 7.857984 7.464360 7.070706 6.677031 6.283349 5.995900 5.745877\n [694] 6.012037 6.298728 6.585402 6.872071 7.158751 7.445448 7.404565 7.296244 7.144922\n [703] 6.993605 6.842290 6.690975 6.539655 6.470777 6.459894 6.449008 6.438119 6.307879\n [712] 6.170965 6.034052 5.897136 5.760216 5.784200 5.824093 5.763614 5.534245 5.310905\n [721] 5.088768 4.866625 4.644480 4.422334 4.225879 4.118087 4.044725 4.120443 4.196162\n [730] 4.271890 4.347626 4.303682 4.2573",
        "92 4.247512 4.296532 4.345554 4.394579 4.443605\n [739] 4.492632 4.541656 4.590679 4.647708 4.711560 4.810889 4.916511 5.022134 5.127768\n [748] 5.225468 5.300314 5.375179 5.451503 5.552232 5.652965 7.709128 7.819167 7.929201\n [757] 8.039227 8.149247 8.259269 8.286824 7.893209 7.499583 7.105929 6.712256 6.449756\n [766] 6.199736 5.949715 5.996577 6.283268 6.569937 6.856601 7.143280 7.349017 7.297980\n [775] 7.232838 7.081517 6.930198 6.778879 6.627559 6.545686 6.534805 6.523922 6.513037\n [784] 6.502149 6.455564",
        " 6.318649 6.181737 6.044826 5.907913 5.770996 5.634074 5.509854\n [793] 5.312263 5.090134 4.868005 4.645872 4.423732 4.201588 3.979443 3.819381 3.824803\n [802] 3.900526 3.976241 4.051958 4.127686 4.138329 4.092039 4.127287 4.176310 4.225334\n [811] 4.274358 4.323379 4.372397 4.421414 4.470431 4.548228 4.593014 4.689047 4.794676\n [820] 4.900301 5.005930 5.110341 5.185189 5.260052 5.346596 5.447329 5.548066 5.648809\n [829] 5.749554 5.850297 5.975806 7.317864 7.427909 7.537953 7.647994 7.758032 7.868067\n [838] 7",
        ".978100 8.088139 7.928442 7.534801 7.153602 6.903593 6.653583 6.403569 6.153552\n [847] 5.981117 6.267808 6.554472 6.841130 7.127807 7.242425 7.191397 7.140379 7.018112\n [856] 6.866789 6.715466 6.620596 6.609715 6.598832 6.587948 6.577063 6.566176 6.555290\n [865] 6.466333 6.329416 6.192502 6.055588 5.918674 5.781758 5.663085 5.473092 5.207348\n [874] 4.941604 4.675858 4.410106 4.144350 3.878593 3.603281 3.608668 3.680594 3.756313\n [883] 3.832027 3.907747 3.972967 3.958033 4.007057 4.056080 4.105100 4.184977 4",
        ".287661\n [892] 4.390344 4.493030 4.595717 4.672142 4.648722 4.625302 4.672837 4.778468 4.884096\n [901] 4.989731 5.070065 5.144924 5.241696 5.342433 5.443174 5.543917 5.659744 5.783465\n [910] 5.914132 6.025847 6.097660 6.169479 6.241304 6.313131 6.384958 6.969756 7.069454\n [919] 7.169151 7.268849 7.368547 7.476818 7.586863 7.696908 7.806952 7.916995 7.607423\n [928] 7.357412 7.107404 6.857399 6.607393 6.357381 6.107365 6.252345 6.539004 6.825658\n [937] 7.112333 7.135835 7.084816 7.033801 6.954706 6.803379 6.6",
        "95511 6.684629 6.673745\n [946] 6.662861 6.651976 6.641090 6.630205 6.619320 6.608437 6.477104 6.340185 6.203266\n [955] 6.066348 5.949134 5.833352 5.703962 5.438211 5.172463 4.906719 4.640973 4.375224\n [964] 4.093260 3.767677 3.694380 3.721802 3.749213 3.776622 3.804034 3.831453 3.924397\n [973] 4.027087 4.129775 4.232460 4.335143 4.437826 4.540511 4.643200 4.745892 4.727846\n [982] 4.704426 4.681008 4.657591 4.656628 4.762261 4.867893 4.954938 5.036063 5.136801\n [991] 5.237541 5.346401 5.470120 5.593840 5.717",
        "562 5.850570 5.987154 6.075895 6.147713\n[1000] 6.219537\n [ reached getOption(\"max.print\") -- omitted 12682 entries ]\n",
        "> ",
        "pred_mm$V3 %>% range()",
        "[1]  2.115509 15.001573\n",
        "> ",
        "pred_mm$V3 %>% range()",
        "[1]  2.115509 15.001573\n",
        "> ",
        "pred_ll$V3 %>% range()",
        "[1] -0.925845 13.561227\n",
        "> ",
        "pred_uu$V3 %>% range()",
        "Error: object 'pred_uu' not found\n",
        "> ",
        "pred_mm <- as.data.frame(cbind(coord_pred, model_4_1$summary.fitted.values[idxs_pred, \"mean\"]))",
        "> ",
        "pred_ll <- as.data.frame(cbind(coord_pred, model_4_1$summary.fitted.values[idxs_pred, \"0.025quant\"]))",
        "> ",
        "pred_uu <- as.data.frame(cbind(coord_pred, model_4_1$summary.fitted.values[idxs_pred, \"0.975quant\"]))",
        "> ",
        "pred_mm$V3 %>% range()",
        "[1]  2.115509 15.001573\n",
        "> ",
        "pred_ll$V3 %>% range()",
        "[1] -0.925845 13.561227\n",
        "> ",
        "pred_uu$V3 %>% range()",
        "[1]  4.582006 16.448814\n",
        "> ",
        "pred_mm <- as.data.frame(cbind(coord_pred, model_4_1$summary.fitted.values[idxs_pred, \"mean\"]))",
        "> ",
        "pred_ll <- as.data.frame(cbind(coord_pred, model_4_1$summary.fitted.values[idxs_pred, \"0.025quant\"]))",
        "> ",
        "pred_uu <- as.data.frame(cbind(coord_pred, model_4_1$summary.fitted.values[idxs_pred, \"0.975quant\"]))",
        "> ",
        "r_mm <- pred_mm$V3 %>% range()",
        "> ",
        "r_ll <- pred_ll$V3 %>% range()",
        "> ",
        "r_uu <- pred_uu$V3 %>% range()",
        "> ",
        "r",
        "Error: object 'r' not found\n",
        "> ",
        "r_mm <- pred_mm$V3 %>% range()",
        "> ",
        "r_ll <- pred_ll$V3 %>% range()",
        "> ",
        "r_uu <- pred_uu$V3 %>% range()",
        "> ",
        "r <- c(min(r_mm[1], r_ll[1], r_uu[1]), max(r_mm[2], r_ll[2], r_uu[2]))",
        "> ",
        "r",
        "[1] -0.925845 16.448814\n",
        "> ",
        "limits",
        "Error: object 'limits' not found\n",
        "> ",
        "labs <- seq(round(min(c(fitted_latent_0025_df$estimated, fitted_latent_0975_df$estimated)) - 0.01, 2), round(max(c(fitted_latent_0025_df$estimated, fitted_latent_0975_df$estimated)) + 0.01, 2), length.out = 6)",
        "Error: object 'fitted_latent_0025_df' not found\n",
        "> ",
        "labs <- seq(floor(r[1]), ceiling(r[2]), length.out = 6)",
        "> ",
        "labs",
        "[1] -1.0  2.6  6.2  9.8 13.4 17.0\n",
        "> ",
        "breaks",
        "Error: object 'breaks' not found\n",
        "> ",
        "breaks <- seq(floor(r[1]), ceiling(r[2]), length.out = 6)",
        "> ",
        "pp <- ggplot() +",
        "+ ",
        "  geom_tile(data = pred_mm_df, mapping = aes(x = x, y = y, fill = pred)) + ",
        "+ ",
        "  geom_sf(data = USA, color = \"black\", fill = NA, lwd = 0.5) +",
        "+ ",
        "  scale_fill_gradientn(name = \"PM2.5\", colors = rainbow(9, start = 0.1, end = 0.9), breaks = breaks, limits = c(breaks[1], tail(breaks, 1))) + ",
        "+ ",
        "  labs(x = \"\", y = \"\", title = tt) + ",
        "+ ",
        "  custom_theme + ",
        "+ ",
        "  theme(axis.text.x = element_blank(),",
        "+ ",
        "        axis.text.y = element_blank(),",
        "+ ",
        "        axis.ticks  = element_blank())",
        "> ",
        "pp",
        "> ",
        "plot_pred_USA <- function (fitted_values, USA, r, tt = \"\", ...) {",
        "+ ",
        "  ",
        "+ ",
        "  coordinates(fitted_values) <- ~ x + y",
        "+ ",
        "  gridded(fitted_values) <- TRUE",
        "+ ",
        "  fitted_values <- raster(fitted_values)",
        "+ ",
        "  crs(fitted_values) <- \"+init=epsg:6345 +units=km +no_defs\"",
        "+ ",
        "  ",
        "+ ",
        "  fitted_values    <- as(fitted_values, \"SpatialPixelsDataFrame\")",
        "+ ",
        "  fitted_values_df <- as.data.frame(fitted_values)",
        "+ ",
        "  colnames(fitted_values_df) <- c(\"pred\", \"x\", \"y\")",
        "+ ",
        "  ",
        "+ ",
        "  breaks <- seq(floor(r[1]), ceiling(r[2]), length.out = 1)",
        "+ ",
        "  ",
        "+ ",
        "  pp <- ggplot() +",
        "+ ",
        "    geom_tile(data = fitted_values_df, mapping = aes(x = x, y = y, fill = pred)) + ",
        "+ ",
        "    geom_sf(data = USA, color = \"black\", fill = NA, lwd = 0.5) +",
        "+ ",
        "    scale_fill_gradientn(name = \"PM2.5\", colors = rainbow(9, start = 0.1, end = 0.9), breaks = breaks, limits = c(breaks[1], tail(breaks, 1))) + ",
        "+ ",
        "    labs(x = \"\", y = \"\", title = tt) + ",
        "+ ",
        "    custom_theme + ",
        "+ ",
        "    theme(axis.text.x = element_blank(),",
        "+ ",
        "          axis.text.y = element_blank(),",
        "+ ",
        "          axis.ticks  = element_blank())",
        "+ ",
        "  ",
        "+ ",
        "  pp",
        "+ ",
        "} ",
        "> ",
        "plot_pred_USA(fitted_values = r_mm, USA = USA, r = r, tt = \"Posterior Mean\")",
        "Error in (function (classes, fdef, mtable)  : \n  unable to find an inherited method for function ‘coordinates<-’ for signature ‘\"numeric\"’\n",
        "> ",
        "plot_pred_USA <- function (fitted_values, USA, r, tt = \"\", ...) {",
        "+ ",
        "  ",
        "+ ",
        "  coordinates(fitted_values) <- ~ x + y",
        "+ ",
        "  gridded(fitted_values) <- TRUE",
        "+ ",
        "  fitted_values <- raster(fitted_values)",
        "+ ",
        "  crs(fitted_values) <- \"+init=epsg:6345 +units=km +no_defs\"",
        "+ ",
        "  ",
        "+ ",
        "  fitted_values    <- as(fitted_values, \"SpatialPixelsDataFrame\")",
        "+ ",
        "  fitted_values_df <- as.data.frame(fitted_values)",
        "+ ",
        "  colnames(fitted_values_df) <- c(\"pred\", \"x\", \"y\")",
        "+ ",
        "  ",
        "+ ",
        "  breaks <- seq(floor(r[1]), ceiling(r[2]), length.out = 1)",
        "+ ",
        "  ",
        "+ ",
        "  pp <- ggplot() +",
        "+ ",
        "    geom_tile(data = fitted_values_df, mapping = aes(x = x, y = y, fill = pred)) + ",
        "+ ",
        "    geom_sf(data = USA, color = \"black\", fill = NA, lwd = 0.5) +",
        "+ ",
        "    scale_fill_gradientn(name = \"PM2.5\", colors = rainbow(9, start = 0.1, end = 0.9), breaks = breaks, limits = c(breaks[1], tail(breaks, 1))) + ",
        "+ ",
        "    labs(x = \"\", y = \"\", title = tt) + ",
        "+ ",
        "    custom_theme + ",
        "+ ",
        "    theme(axis.text.x = element_blank(),",
        "+ ",
        "          axis.text.y = element_blank(),",
        "+ ",
        "          axis.ticks  = element_blank())",
        "+ ",
        "  ",
        "+ ",
        "  pp",
        "+ ",
        "} ",
        "> ",
        "plot_pred_USA(fitted_values = r_mm, USA = USA, r = r, tt = \"Posterior Mean\")",
        "Error in (function (classes, fdef, mtable)  : \n  unable to find an inherited method for function ‘coordinates<-’ for signature ‘\"numeric\"’\n",
        "> ",
        "# Fitted values and prediction",
        "> ",
        "idxs_pred <- inla.stack.index(stk_full, tag = \"pred\")$data",
        "> ",
        "pred_mm <- as.data.frame(cbind(coord_pred, model_4_1$summary.fitted.values[idxs_pred, \"mean\"]))",
        "> ",
        "pred_ll <- as.data.frame(cbind(coord_pred, model_4_1$summary.fitted.values[idxs_pred, \"0.025quant\"]))",
        "> ",
        "pred_uu <- as.data.frame(cbind(coord_pred, model_4_1$summary.fitted.values[idxs_pred, \"0.975quant\"]))",
        "> ",
        "r_mm <- pred_mm$V3 %>% range()",
        "> ",
        "r_ll <- pred_ll$V3 %>% range()",
        "> ",
        "r_uu <- pred_uu$V3 %>% range()",
        "> ",
        "r <- c(min(r_mm[1], r_ll[1], r_uu[1]), max(r_mm[2], r_ll[2], r_uu[2]))",
        "> ",
        "tt <- \"Posterior Mean\"",
        "> ",
        "plot_pred_USA(fitted_values = r_mm, USA = USA, r = r, tt = \"Posterior Mean\")",
        "Error in (function (classes, fdef, mtable)  : \n  unable to find an inherited method for function ‘coordinates<-’ for signature ‘\"numeric\"’\n",
        "> ",
        "fitted_values = r_mm",
        "> ",
        "  coordinates(fitted_values) <- ~ x + y",
        "Error in (function (classes, fdef, mtable)  : \n  unable to find an inherited method for function ‘coordinates<-’ for signature ‘\"numeric\"’\n",
        "> ",
        "fitted_values",
        "[1]  2.115509 15.001573\n",
        "> ",
        "pred_mm <- as.data.frame(cbind(coord_pred, model_4_1$summary.fitted.values[idxs_pred, \"mean\"]))",
        "> ",
        "pred_mm",
        "             x       y        V3\n1   1025.57062 2732.56  6.989426\n2   1050.57062 2732.56  6.973971\n3   1075.57062 2732.56  6.929429\n4   1075.57062 2757.56  6.983512\n5   1125.57062 2757.56  6.946815\n6   1100.57062 2782.56  6.967369\n7   1125.57062 2782.56  6.956930\n8   1150.57062 2782.56  6.981722\n9   1100.57062 2807.56  7.021455\n10  1125.57062 2807.56  6.967046\n11  1150.57062 2807.56  6.991839\n12  1175.57062 2807.56  7.016626\n13  1100.57062 2832.56  7.075539\n14  1125.57062 2832.56  7.005311\n15  1150.57062 28",
        "32.56  7.001951\n16  1175.57062 2832.56  7.026739\n17  1075.57062 2857.56  7.199846\n18  1100.57062 2857.56  7.129618\n19  1125.57062 2857.56  7.059387\n20  1150.57062 2857.56  7.026652\n21  1175.57062 2857.56  7.070298\n22  1025.57062 2882.56  7.394375\n23  1050.57062 2882.56  7.324149\n24  1075.57062 2882.56  7.253933\n25  1100.57062 2882.56  7.201604\n26  1125.57062 2882.56  7.149275\n27  1150.57062 2882.56  7.096945\n28  1175.57062 2882.56  7.122301\n29  -549.42938 2907.56 10.486455\n30  1025.57062 2907.56  7.452503\n3",
        "1  1050.57062 2907.56  7.400174\n32  1075.57062 2907.56  7.347846\n33  1100.57062 2907.56  7.295518\n34  1125.57062 2907.56  7.243190\n35  1150.57062 2907.56  7.190862\n36  1175.57062 2907.56  7.174302\n37  -624.42938 2932.56 10.580851\n38  -599.42938 2932.56 10.678561\n39  -574.42938 2932.56 10.776263\n40  -549.42938 2932.56 10.873975\n41  -524.42938 2932.56 10.753537\n42  1000.57062 2932.56  7.572869\n43  1025.57062 2932.56  7.546415\n44  1050.57062 2932.56  7.494086\n45  1075.57062 2932.56  7.441757\n46  1100.57062 293",
        "2.56  7.389428\n47  1125.57062 2932.56  7.337099\n48  1150.57062 2932.56  7.284772\n49  1175.57062 2932.56  7.232444\n50  -649.42938 2957.56 10.733968\n51  -624.42938 2957.56 10.903482\n52  -599.42938 2957.56 11.066082\n53  -574.42938 2957.56 11.163796\n54  -549.42938 2957.56 11.210343\n55  -524.42938 2957.56 11.013233\n56   975.57062 2957.56  7.614384\n57  1000.57062 2957.56  7.598279\n58  1025.57062 2957.56  7.572392\n59  1050.57062 2957.56  7.546505\n60  1075.57062 2957.56  7.520618\n61  1100.57062 2957.56  7.483340\n62",
        "  1125.57062 2957.56  7.431010\n63  1150.57062 2957.56  7.378681\n64  1175.57062 2957.56  7.326353\n65  -699.42938 2982.56 10.581373\n66  -674.42938 2982.56 10.750882\n67  -649.42938 2982.56 10.920389\n68  -624.42938 2982.56 11.089911\n69  -599.42938 2982.56 11.259453\n70  -574.42938 2982.56 11.365658\n71  -549.42938 2982.56 11.344369\n72  -524.42938 2982.56 11.079755\n73   975.57062 2982.56  7.638043\n74  1000.57062 2982.56  7.622804\n75  1025.57062 2982.56  7.597803\n76  1050.57062 2982.56  7.571915\n77  1075.57062 2982",
        ".56  7.546028\n78  1100.57062 2982.56  7.520141\n79  1125.57062 2982.56  7.494255\n80  1150.57062 2982.56  7.468369\n81  1175.57062 2982.56  7.420266\n82  -699.42938 3007.56 10.767799\n83  -674.42938 3007.56 10.937318\n84  -649.42938 3007.56 11.038107\n85  -624.42938 3007.56 11.104546\n86  -599.42938 3007.56 11.170992\n87  -574.42938 3007.56 11.237444\n88  -549.42938 3007.56 11.226995\n89   950.57062 3007.56  7.676943\n90   975.57062 3007.56  7.661702\n91  1000.57062 3007.56  7.646463\n92  1025.57062 3007.56  7.623214\n93 ",
        " 1050.57062 3007.56  7.597326\n94  1075.57062 3007.56  7.571439\n95  1100.57062 3007.56  7.545552\n96  1125.57062 3007.56  7.519666\n97  1150.57062 3007.56  7.493780\n98  1175.57062 3007.56  7.467894\n99  -724.42938 3032.56 10.710587\n100 -699.42938 3032.56 10.777020\n101 -674.42938 3032.56 10.843452\n102 -649.42938 3032.56 10.909886\n103 -624.42938 3032.56 10.976327\n104 -599.42938 3032.56 11.042777\n105 -574.42938 3032.56 11.084333\n106 -549.42938 3032.56 11.067794\n107  950.57062 3032.56  7.700602\n108  975.57062 3032.",
        "56  7.685361\n109 1000.57062 3032.56  7.670122\n110 1025.57062 3032.56  7.648625\n111 1050.57062 3032.56  7.622738\n112 1075.57062 3032.56  7.596851\n113 1100.57062 3032.56  7.570964\n114 1125.57062 3032.56  7.545078\n115 1150.57062 3032.56  7.519191\n116 1175.57062 3032.56  7.487513\n117 -724.42938 3057.56 10.582368\n118 -699.42938 3057.56 10.648801\n119 -674.42938 3057.56 10.715232\n120 -649.42938 3057.56 10.781666\n121 -624.42938 3057.56 10.848111\n122 -599.42938 3057.56 10.914564\n123 -574.42938 3057.56 10.925131\n124 ",
        "-549.42938 3057.56 10.908598\n125 -524.42938 3057.56 10.892075\n126  925.57062 3057.56  7.739503\n127  950.57062 3057.56  7.724261\n128  975.57062 3057.56  7.709020\n129 1000.57062 3057.56  7.693782\n130 1025.57062 3057.56  7.674037\n131 1050.57062 3057.56  7.648150\n132 1075.57062 3057.56  7.622263\n133 1100.57062 3057.56  7.596377\n134 1125.57062 3057.56  7.564957\n135 1150.57062 3057.56  7.533272\n136 -724.42938 3082.56 10.454149\n137 -699.42938 3082.56 10.520582\n138 -674.42938 3082.56 10.587014\n139 -649.42938 3082.5",
        "6 10.653451\n140 -624.42938 3082.56 10.719898\n141 -599.42938 3082.56 10.782472\n142 -574.42938 3082.56 10.765934\n143 -549.42938 3082.56 10.749407\n144 -524.42938 3082.56 10.732887\n145  925.57062 3082.56  7.763162\n146  950.57062 3082.56  7.747921\n147  975.57062 3082.56  7.732680\n148 1000.57062 3082.56  7.717441\n149 1025.57062 3082.56  7.699448\n150 1050.57062 3082.56  7.673562\n151 1075.57062 3082.56  7.642403\n152 1100.57062 3082.56  7.610717\n153 1125.57062 3082.56  7.579032\n154 1150.57062 3082.56  7.547349\n155 -",
        "724.42938 3107.56 10.325931\n156 -699.42938 3107.56 10.392364\n157 -674.42938 3107.56 10.458798\n158 -649.42938 3107.56 10.525239\n159 -624.42938 3107.56 10.591689\n160 -599.42938 3107.56 10.623274\n161 -574.42938 3107.56 10.606743\n162 -549.42938 3107.56 10.590221\n163 -524.42938 3107.56 10.573699\n164 -499.42938 3107.56 10.557170\n165  925.57062 3107.56  7.783048\n166  950.57062 3107.56  7.766493\n167  975.57062 3107.56  7.749938\n168 1000.57062 3107.56  7.733385\n169 1025.57062 3107.56  7.716125\n170 1050.57062 3107.56",
        "  7.688162\n171 1075.57062 3107.56  7.656477\n172 1100.57062 3107.56  7.624792\n173 1125.57062 3107.56  7.593109\n174 -749.42938 3132.56 10.078541\n175 -724.42938 3132.56 10.197161\n176 -699.42938 3132.56 10.264149\n177 -674.42938 3132.56 10.330586\n178 -649.42938 3132.56 10.397030\n179 -624.42938 3132.56 10.463479\n180 -599.42938 3132.56 10.464081\n181 -574.42938 3132.56 10.447556\n182 -549.42938 3132.56 10.431035\n183 -524.42938 3132.56 10.414508\n184 -499.42938 3132.56 10.397974\n185  925.57062 3132.56  7.782412\n186  9",
        "50.57062 3132.56  7.765857\n187  975.57062 3132.56  7.749302\n188 1000.57062 3132.56  7.732748\n189 1025.57062 3132.56  7.716196\n190 1050.57062 3132.56  7.691722\n191 1075.57062 3132.56  7.666024\n192 1100.57062 3132.56  7.638868\n193 1125.57062 3132.56  7.607186\n194 -774.42938 3157.56  9.782130\n195 -749.42938 3157.56  9.900751\n196 -724.42938 3157.56 10.019371\n197 -699.42938 3157.56 10.135935\n198 -674.42938 3157.56 10.202375\n199 -649.42938 3157.56 10.268820\n200 -624.42938 3157.56 10.321417\n201 -599.42938 3157.56 ",
        "10.304890\n202 -574.42938 3157.56 10.288368\n203 -549.42938 3157.56 10.271844\n204 -524.42938 3157.56 10.255312\n205 -499.42938 3157.56 10.238775\n206 -474.42938 3157.56 10.222234\n207 -449.42938 3157.56 10.205694\n208  925.57062 3157.56  7.781776\n209  950.57062 3157.56  7.765221\n210  975.57062 3157.56  7.748666\n211 1000.57062 3157.56  7.732112\n212 1025.57062 3157.56  7.715559\n213 1050.57062 3157.56  7.693017\n214 1075.57062 3157.56  7.667320\n215 1100.57062 3157.56  7.641624\n216 1125.57062 3157.56  7.615930\n217 -77",
        "4.42938 3182.56  9.604341\n218 -749.42938 3182.56  9.722962\n219 -724.42938 3182.56  9.841584\n220 -699.42938 3182.56  9.960208\n221 -674.42938 3182.56 10.074164\n222 -649.42938 3182.56 10.140609\n223 -624.42938 3182.56 10.162223\n224 -599.42938 3182.56 10.145699\n225 -574.42938 3182.56 10.129176\n226 -549.42938 3182.56 10.112649\n227 -524.42938 3182.56 10.096113\n228 -499.42938 3182.56 10.079573\n229 -474.42938 3182.56 10.063032\n230 -449.42938 3182.56 10.046490\n231 -424.42938 3182.56  9.933467\n232  925.57062 3182.56  ",
        "7.772488\n233  950.57062 3182.56  7.764585\n234  975.57062 3182.56  7.748031\n235 1000.57062 3182.56  7.731476\n236 1025.57062 3182.56  7.714923\n237 1050.57062 3182.56  7.694312\n238 1075.57062 3182.56  7.668615\n239 1100.57062 3182.56  7.642920\n240 1125.57062 3182.56  7.617227\n241 -799.42938 3207.56  9.307928\n242 -774.42938 3207.56  9.426552\n243 -749.42938 3207.56  9.545176\n244 -724.42938 3207.56  9.663799\n245 -699.42938 3207.56  9.782424\n246 -674.42938 3207.56  9.901051\n247 -649.42938 3207.56 10.012397\n248 -624",
        ".42938 3207.56 10.003030\n249 -599.42938 3207.56  9.987683\n250 -574.42938 3207.56  9.978319\n251 -549.42938 3207.56  9.968950\n252 -524.42938 3207.56  9.959575\n253 -499.42938 3207.56  9.950196\n254 -474.42938 3207.56  9.940816\n255 -449.42938 3207.56  9.931437\n256 -424.42938 3207.56  9.948518\n257 -399.42938 3207.56 10.017854\n258 -374.42938 3207.56  9.898363\n259 -349.42938 3207.56  9.778870\n260  275.57062 3207.56  7.658137\n261  925.57062 3207.56  7.749049\n262  950.57062 3207.56  7.749985\n263  975.57062 3207.56  7",
        ".747395\n264 1000.57062 3207.56  7.730841\n265 1025.57062 3207.56  7.714287\n266 1050.57062 3207.56  7.695607\n267 1075.57062 3207.56  7.669910\n268 1100.57062 3207.56  7.644215\n269 -799.42938 3232.56  9.130139\n270 -774.42938 3232.56  9.248765\n271 -749.42938 3232.56  9.367390\n272 -724.42938 3232.56  9.487808\n273 -699.42938 3232.56  9.609027\n274 -674.42938 3232.56  9.730247\n275 -649.42938 3232.56  9.846888\n276 -624.42938 3232.56  9.913939\n277 -599.42938 3232.56  9.904574\n278 -574.42938 3232.56  9.895212\n279 -549.",
        "42938 3232.56  9.885846\n280 -524.42938 3232.56  9.876473\n281 -499.42938 3232.56  9.867096\n282 -474.42938 3232.56  9.857716\n283 -449.42938 3232.56  9.848337\n284 -424.42938 3232.56  9.877077\n285 -399.42938 3232.56  9.969896\n286 -374.42938 3232.56 10.062715\n287 -349.42938 3232.56 10.054313\n288 -324.42938 3232.56  9.934824\n289 -299.42938 3232.56  9.815327\n290  100.57062 3232.56  7.713831\n291  125.57062 3232.56  7.702215\n292  150.57062 3232.56  7.699666\n293  175.57062 3232.56  7.711382\n294  200.57062 3232.56  7.",
        "723098\n295  225.57062 3232.56  7.734815\n296  250.57062 3232.56  7.746532\n297  275.57062 3232.56  7.776536\n298  300.57062 3232.56  7.815419\n299  875.57062 3232.56  7.723727\n300  900.57062 3232.56  7.724668\n301  925.57062 3232.56  7.725607\n302  950.57062 3232.56  7.726545\n303  975.57062 3232.56  7.727482\n304 1000.57062 3232.56  7.728420\n305 1025.57062 3232.56  7.713651\n306 1050.57062 3232.56  7.696903\n307 1075.57062 3232.56  7.671205\n308 -824.42938 3257.56  8.836756\n309 -799.42938 3257.56  8.957978\n310 -774.4",
        "2938 3257.56  9.079200\n311 -749.42938 3257.56  9.200422\n312 -724.42938 3257.56  9.321642\n313 -699.42938 3257.56  9.442861\n314 -674.42938 3257.56  9.564078\n315 -649.42938 3257.56  9.674362\n316 -624.42938 3257.56  9.764852\n317 -599.42938 3257.56  9.821467\n318 -574.42938 3257.56  9.812103\n319 -549.42938 3257.56  9.802740\n320 -524.42938 3257.56  9.793371\n321 -499.42938 3257.56  9.783995\n322 -474.42938 3257.56  9.774617\n323 -449.42938 3257.56  9.765238\n324 -424.42938 3257.56  9.805637\n325 -399.42938 3257.56  9.8",
        "98455\n326 -374.42938 3257.56  9.991273\n327 -349.42938 3257.56 10.084089\n328 -324.42938 3257.56 10.176900\n329 -299.42938 3257.56 10.090757\n330 -274.42938 3257.56  9.971259\n331   50.57062 3257.56  7.880202\n332   75.57062 3257.56  7.868589\n333  100.57062 3257.56  7.856975\n [ reached 'max' / getOption(\"max.print\") -- omitted 13349 rows ]\n",
        "> ",
        "plot_pred_USA(fitted_values = pred_mm, USA = USA, r = r, tt = \"Posterior Mean\")",
        "> ",
        "pred_mm <- as.data.frame(cbind(coord_pred, model_4_1$summary.fitted.values[idxs_pred, \"mean\"]))",
        "> ",
        "pred_ll <- as.data.frame(cbind(coord_pred, model_4_1$summary.fitted.values[idxs_pred, \"0.025quant\"]))",
        "> ",
        "pred_uu <- as.data.frame(cbind(coord_pred, model_4_1$summary.fitted.values[idxs_pred, \"0.975quant\"]))",
        "> ",
        "r_mm <- pred_mm$V3 %>% range()",
        "> ",
        "r_ll <- pred_ll$V3 %>% range()",
        "> ",
        "r_uu <- pred_uu$V3 %>% range()",
        "> ",
        "r <- c(min(r_mm[1], r_ll[1], r_uu[1]), max(r_mm[2], r_ll[2], r_uu[2]))",
        "> ",
        "tt <- \"Posterior Mean\"",
        "> ",
        "plot_pred_USA(fitted_values = pred_mm, USA = USA, r = r, tt = \"Posterior Mean\")",
        "> ",
        "r",
        "[1] -0.925845 16.448814\n",
        "> ",
        "pred_mm",
        "             x       y        V3\n1   1025.57062 2732.56  6.989426\n2   1050.57062 2732.56  6.973971\n3   1075.57062 2732.56  6.929429\n4   1075.57062 2757.56  6.983512\n5   1125.57062 2757.56  6.946815\n6   1100.57062 2782.56  6.967369\n7   1125.57062 2782.56  6.956930\n8   1150.57062 2782.56  6.981722\n9   1100.57062 2807.56  7.021455\n10  1125.57062 2807.56  6.967046\n11  1150.57062 2807.56  6.991839\n12  1175.57062 2807.56  7.016626\n13  1100.57062 2832.56  7.075539\n14  1125.57062 2832.56  7.005311\n15  1150.57062 28",
        "32.56  7.001951\n16  1175.57062 2832.56  7.026739\n17  1075.57062 2857.56  7.199846\n18  1100.57062 2857.56  7.129618\n19  1125.57062 2857.56  7.059387\n20  1150.57062 2857.56  7.026652\n21  1175.57062 2857.56  7.070298\n22  1025.57062 2882.56  7.394375\n23  1050.57062 2882.56  7.324149\n24  1075.57062 2882.56  7.253933\n25  1100.57062 2882.56  7.201604\n26  1125.57062 2882.56  7.149275\n27  1150.57062 2882.56  7.096945\n28  1175.57062 2882.56  7.122301\n29  -549.42938 2907.56 10.486455\n30  1025.57062 2907.56  7.452503\n3",
        "1  1050.57062 2907.56  7.400174\n32  1075.57062 2907.56  7.347846\n33  1100.57062 2907.56  7.295518\n34  1125.57062 2907.56  7.243190\n35  1150.57062 2907.56  7.190862\n36  1175.57062 2907.56  7.174302\n37  -624.42938 2932.56 10.580851\n38  -599.42938 2932.56 10.678561\n39  -574.42938 2932.56 10.776263\n40  -549.42938 2932.56 10.873975\n41  -524.42938 2932.56 10.753537\n42  1000.57062 2932.56  7.572869\n43  1025.57062 2932.56  7.546415\n44  1050.57062 2932.56  7.494086\n45  1075.57062 2932.56  7.441757\n46  1100.57062 293",
        "2.56  7.389428\n47  1125.57062 2932.56  7.337099\n48  1150.57062 2932.56  7.284772\n49  1175.57062 2932.56  7.232444\n50  -649.42938 2957.56 10.733968\n51  -624.42938 2957.56 10.903482\n52  -599.42938 2957.56 11.066082\n53  -574.42938 2957.56 11.163796\n54  -549.42938 2957.56 11.210343\n55  -524.42938 2957.56 11.013233\n56   975.57062 2957.56  7.614384\n57  1000.57062 2957.56  7.598279\n58  1025.57062 2957.56  7.572392\n59  1050.57062 2957.56  7.546505\n60  1075.57062 2957.56  7.520618\n61  1100.57062 2957.56  7.483340\n62",
        "  1125.57062 2957.56  7.431010\n63  1150.57062 2957.56  7.378681\n64  1175.57062 2957.56  7.326353\n65  -699.42938 2982.56 10.581373\n66  -674.42938 2982.56 10.750882\n67  -649.42938 2982.56 10.920389\n68  -624.42938 2982.56 11.089911\n69  -599.42938 2982.56 11.259453\n70  -574.42938 2982.56 11.365658\n71  -549.42938 2982.56 11.344369\n72  -524.42938 2982.56 11.079755\n73   975.57062 2982.56  7.638043\n74  1000.57062 2982.56  7.622804\n75  1025.57062 2982.56  7.597803\n76  1050.57062 2982.56  7.571915\n77  1075.57062 2982",
        ".56  7.546028\n78  1100.57062 2982.56  7.520141\n79  1125.57062 2982.56  7.494255\n80  1150.57062 2982.56  7.468369\n81  1175.57062 2982.56  7.420266\n82  -699.42938 3007.56 10.767799\n83  -674.42938 3007.56 10.937318\n84  -649.42938 3007.56 11.038107\n85  -624.42938 3007.56 11.104546\n86  -599.42938 3007.56 11.170992\n87  -574.42938 3007.56 11.237444\n88  -549.42938 3007.56 11.226995\n89   950.57062 3007.56  7.676943\n90   975.57062 3007.56  7.661702\n91  1000.57062 3007.56  7.646463\n92  1025.57062 3007.56  7.623214\n93 ",
        " 1050.57062 3007.56  7.597326\n94  1075.57062 3007.56  7.571439\n95  1100.57062 3007.56  7.545552\n96  1125.57062 3007.56  7.519666\n97  1150.57062 3007.56  7.493780\n98  1175.57062 3007.56  7.467894\n99  -724.42938 3032.56 10.710587\n100 -699.42938 3032.56 10.777020\n101 -674.42938 3032.56 10.843452\n102 -649.42938 3032.56 10.909886\n103 -624.42938 3032.56 10.976327\n104 -599.42938 3032.56 11.042777\n105 -574.42938 3032.56 11.084333\n106 -549.42938 3032.56 11.067794\n107  950.57062 3032.56  7.700602\n108  975.57062 3032.",
        "56  7.685361\n109 1000.57062 3032.56  7.670122\n110 1025.57062 3032.56  7.648625\n111 1050.57062 3032.56  7.622738\n112 1075.57062 3032.56  7.596851\n113 1100.57062 3032.56  7.570964\n114 1125.57062 3032.56  7.545078\n115 1150.57062 3032.56  7.519191\n116 1175.57062 3032.56  7.487513\n117 -724.42938 3057.56 10.582368\n118 -699.42938 3057.56 10.648801\n119 -674.42938 3057.56 10.715232\n120 -649.42938 3057.56 10.781666\n121 -624.42938 3057.56 10.848111\n122 -599.42938 3057.56 10.914564\n123 -574.42938 3057.56 10.925131\n124 ",
        "-549.42938 3057.56 10.908598\n125 -524.42938 3057.56 10.892075\n126  925.57062 3057.56  7.739503\n127  950.57062 3057.56  7.724261\n128  975.57062 3057.56  7.709020\n129 1000.57062 3057.56  7.693782\n130 1025.57062 3057.56  7.674037\n131 1050.57062 3057.56  7.648150\n132 1075.57062 3057.56  7.622263\n133 1100.57062 3057.56  7.596377\n134 1125.57062 3057.56  7.564957\n135 1150.57062 3057.56  7.533272\n136 -724.42938 3082.56 10.454149\n137 -699.42938 3082.56 10.520582\n138 -674.42938 3082.56 10.587014\n139 -649.42938 3082.5",
        "6 10.653451\n140 -624.42938 3082.56 10.719898\n141 -599.42938 3082.56 10.782472\n142 -574.42938 3082.56 10.765934\n143 -549.42938 3082.56 10.749407\n144 -524.42938 3082.56 10.732887\n145  925.57062 3082.56  7.763162\n146  950.57062 3082.56  7.747921\n147  975.57062 3082.56  7.732680\n148 1000.57062 3082.56  7.717441\n149 1025.57062 3082.56  7.699448\n150 1050.57062 3082.56  7.673562\n151 1075.57062 3082.56  7.642403\n152 1100.57062 3082.56  7.610717\n153 1125.57062 3082.56  7.579032\n154 1150.57062 3082.56  7.547349\n155 -",
        "724.42938 3107.56 10.325931\n156 -699.42938 3107.56 10.392364\n157 -674.42938 3107.56 10.458798\n158 -649.42938 3107.56 10.525239\n159 -624.42938 3107.56 10.591689\n160 -599.42938 3107.56 10.623274\n161 -574.42938 3107.56 10.606743\n162 -549.42938 3107.56 10.590221\n163 -524.42938 3107.56 10.573699\n164 -499.42938 3107.56 10.557170\n165  925.57062 3107.56  7.783048\n166  950.57062 3107.56  7.766493\n167  975.57062 3107.56  7.749938\n168 1000.57062 3107.56  7.733385\n169 1025.57062 3107.56  7.716125\n170 1050.57062 3107.56",
        "  7.688162\n171 1075.57062 3107.56  7.656477\n172 1100.57062 3107.56  7.624792\n173 1125.57062 3107.56  7.593109\n174 -749.42938 3132.56 10.078541\n175 -724.42938 3132.56 10.197161\n176 -699.42938 3132.56 10.264149\n177 -674.42938 3132.56 10.330586\n178 -649.42938 3132.56 10.397030\n179 -624.42938 3132.56 10.463479\n180 -599.42938 3132.56 10.464081\n181 -574.42938 3132.56 10.447556\n182 -549.42938 3132.56 10.431035\n183 -524.42938 3132.56 10.414508\n184 -499.42938 3132.56 10.397974\n185  925.57062 3132.56  7.782412\n186  9",
        "50.57062 3132.56  7.765857\n187  975.57062 3132.56  7.749302\n188 1000.57062 3132.56  7.732748\n189 1025.57062 3132.56  7.716196\n190 1050.57062 3132.56  7.691722\n191 1075.57062 3132.56  7.666024\n192 1100.57062 3132.56  7.638868\n193 1125.57062 3132.56  7.607186\n194 -774.42938 3157.56  9.782130\n195 -749.42938 3157.56  9.900751\n196 -724.42938 3157.56 10.019371\n197 -699.42938 3157.56 10.135935\n198 -674.42938 3157.56 10.202375\n199 -649.42938 3157.56 10.268820\n200 -624.42938 3157.56 10.321417\n201 -599.42938 3157.56 ",
        "10.304890\n202 -574.42938 3157.56 10.288368\n203 -549.42938 3157.56 10.271844\n204 -524.42938 3157.56 10.255312\n205 -499.42938 3157.56 10.238775\n206 -474.42938 3157.56 10.222234\n207 -449.42938 3157.56 10.205694\n208  925.57062 3157.56  7.781776\n209  950.57062 3157.56  7.765221\n210  975.57062 3157.56  7.748666\n211 1000.57062 3157.56  7.732112\n212 1025.57062 3157.56  7.715559\n213 1050.57062 3157.56  7.693017\n214 1075.57062 3157.56  7.667320\n215 1100.57062 3157.56  7.641624\n216 1125.57062 3157.56  7.615930\n217 -77",
        "4.42938 3182.56  9.604341\n218 -749.42938 3182.56  9.722962\n219 -724.42938 3182.56  9.841584\n220 -699.42938 3182.56  9.960208\n221 -674.42938 3182.56 10.074164\n222 -649.42938 3182.56 10.140609\n223 -624.42938 3182.56 10.162223\n224 -599.42938 3182.56 10.145699\n225 -574.42938 3182.56 10.129176\n226 -549.42938 3182.56 10.112649\n227 -524.42938 3182.56 10.096113\n228 -499.42938 3182.56 10.079573\n229 -474.42938 3182.56 10.063032\n230 -449.42938 3182.56 10.046490\n231 -424.42938 3182.56  9.933467\n232  925.57062 3182.56  ",
        "7.772488\n233  950.57062 3182.56  7.764585\n234  975.57062 3182.56  7.748031\n235 1000.57062 3182.56  7.731476\n236 1025.57062 3182.56  7.714923\n237 1050.57062 3182.56  7.694312\n238 1075.57062 3182.56  7.668615\n239 1100.57062 3182.56  7.642920\n240 1125.57062 3182.56  7.617227\n241 -799.42938 3207.56  9.307928\n242 -774.42938 3207.56  9.426552\n243 -749.42938 3207.56  9.545176\n244 -724.42938 3207.56  9.663799\n245 -699.42938 3207.56  9.782424\n246 -674.42938 3207.56  9.901051\n247 -649.42938 3207.56 10.012397\n248 -624",
        ".42938 3207.56 10.003030\n249 -599.42938 3207.56  9.987683\n250 -574.42938 3207.56  9.978319\n251 -549.42938 3207.56  9.968950\n252 -524.42938 3207.56  9.959575\n253 -499.42938 3207.56  9.950196\n254 -474.42938 3207.56  9.940816\n255 -449.42938 3207.56  9.931437\n256 -424.42938 3207.56  9.948518\n257 -399.42938 3207.56 10.017854\n258 -374.42938 3207.56  9.898363\n259 -349.42938 3207.56  9.778870\n260  275.57062 3207.56  7.658137\n261  925.57062 3207.56  7.749049\n262  950.57062 3207.56  7.749985\n263  975.57062 3207.56  7",
        ".747395\n264 1000.57062 3207.56  7.730841\n265 1025.57062 3207.56  7.714287\n266 1050.57062 3207.56  7.695607\n267 1075.57062 3207.56  7.669910\n268 1100.57062 3207.56  7.644215\n269 -799.42938 3232.56  9.130139\n270 -774.42938 3232.56  9.248765\n271 -749.42938 3232.56  9.367390\n272 -724.42938 3232.56  9.487808\n273 -699.42938 3232.56  9.609027\n274 -674.42938 3232.56  9.730247\n275 -649.42938 3232.56  9.846888\n276 -624.42938 3232.56  9.913939\n277 -599.42938 3232.56  9.904574\n278 -574.42938 3232.56  9.895212\n279 -549.",
        "42938 3232.56  9.885846\n280 -524.42938 3232.56  9.876473\n281 -499.42938 3232.56  9.867096\n282 -474.42938 3232.56  9.857716\n283 -449.42938 3232.56  9.848337\n284 -424.42938 3232.56  9.877077\n285 -399.42938 3232.56  9.969896\n286 -374.42938 3232.56 10.062715\n287 -349.42938 3232.56 10.054313\n288 -324.42938 3232.56  9.934824\n289 -299.42938 3232.56  9.815327\n290  100.57062 3232.56  7.713831\n291  125.57062 3232.56  7.702215\n292  150.57062 3232.56  7.699666\n293  175.57062 3232.56  7.711382\n294  200.57062 3232.56  7.",
        "723098\n295  225.57062 3232.56  7.734815\n296  250.57062 3232.56  7.746532\n297  275.57062 3232.56  7.776536\n298  300.57062 3232.56  7.815419\n299  875.57062 3232.56  7.723727\n300  900.57062 3232.56  7.724668\n301  925.57062 3232.56  7.725607\n302  950.57062 3232.56  7.726545\n303  975.57062 3232.56  7.727482\n304 1000.57062 3232.56  7.728420\n305 1025.57062 3232.56  7.713651\n306 1050.57062 3232.56  7.696903\n307 1075.57062 3232.56  7.671205\n308 -824.42938 3257.56  8.836756\n309 -799.42938 3257.56  8.957978\n310 -774.4",
        "2938 3257.56  9.079200\n311 -749.42938 3257.56  9.200422\n312 -724.42938 3257.56  9.321642\n313 -699.42938 3257.56  9.442861\n314 -674.42938 3257.56  9.564078\n315 -649.42938 3257.56  9.674362\n316 -624.42938 3257.56  9.764852\n317 -599.42938 3257.56  9.821467\n318 -574.42938 3257.56  9.812103\n319 -549.42938 3257.56  9.802740\n320 -524.42938 3257.56  9.793371\n321 -499.42938 3257.56  9.783995\n322 -474.42938 3257.56  9.774617\n323 -449.42938 3257.56  9.765238\n324 -424.42938 3257.56  9.805637\n325 -399.42938 3257.56  9.8",
        "98455\n326 -374.42938 3257.56  9.991273\n327 -349.42938 3257.56 10.084089\n328 -324.42938 3257.56 10.176900\n329 -299.42938 3257.56 10.090757\n330 -274.42938 3257.56  9.971259\n331   50.57062 3257.56  7.880202\n332   75.57062 3257.56  7.868589\n333  100.57062 3257.56  7.856975\n [ reached 'max' / getOption(\"max.print\") -- omitted 13349 rows ]\n",
        "> ",
        "plot_pred_USA <- function (fitted_values, USA, r, tt = \"\", ...) {",
        "+ ",
        "  ",
        "+ ",
        "  coordinates(fitted_values) <- ~ x + y",
        "+ ",
        "  gridded(fitted_values) <- TRUE",
        "+ ",
        "  fitted_values <- raster(fitted_values)",
        "+ ",
        "  crs(fitted_values) <- \"+init=epsg:6345 +units=km +no_defs\"",
        "+ ",
        "  ",
        "+ ",
        "  fitted_values    <- as(fitted_values, \"SpatialPixelsDataFrame\")",
        "+ ",
        "  fitted_values_df <- as.data.frame(fitted_values)",
        "+ ",
        "  colnames(fitted_values_df) <- c(\"pred\", \"x\", \"y\")",
        "+ ",
        "  ",
        "+ ",
        "  breaks <- seq(floor(r[1]), ceiling(r[2]), length.out = 1)",
        "+ ",
        "  print(breaks)",
        "+ ",
        "  pp <- ggplot() +",
        "+ ",
        "    geom_tile(data = fitted_values_df, mapping = aes(x = x, y = y, fill = pred)) + ",
        "+ ",
        "    geom_sf(data = USA, color = \"black\", fill = NA, lwd = 0.5) +",
        "+ ",
        "    scale_fill_gradientn(name = \"PM2.5\", colors = rainbow(9, start = 0.1, end = 0.9), breaks = breaks, limits = c(breaks[1], tail(breaks, 1))) + ",
        "+ ",
        "    labs(x = \"\", y = \"\", title = tt) + ",
        "+ ",
        "    custom_theme + ",
        "+ ",
        "    theme(axis.text.x = element_blank(),",
        "+ ",
        "          axis.text.y = element_blank(),",
        "+ ",
        "          axis.ticks  = element_blank())",
        "+ ",
        "  ",
        "+ ",
        "  pp",
        "+ ",
        "} ",
        "> ",
        "plot_pred_USA(fitted_values = pred_mm, USA = USA, r = r, tt = \"Posterior Mean\")",
        "[1] -1\n",
        "> ",
        "r",
        "[1] -0.925845 16.448814\n",
        "> ",
        "plot_pred_USA <- function (fitted_values, USA, r, tt = \"\", ...) {",
        "+ ",
        "  ",
        "+ ",
        "  coordinates(fitted_values) <- ~ x + y",
        "+ ",
        "  gridded(fitted_values) <- TRUE",
        "+ ",
        "  fitted_values <- raster(fitted_values)",
        "+ ",
        "  crs(fitted_values) <- \"+init=epsg:6345 +units=km +no_defs\"",
        "+ ",
        "  ",
        "+ ",
        "  fitted_values    <- as(fitted_values, \"SpatialPixelsDataFrame\")",
        "+ ",
        "  fitted_values_df <- as.data.frame(fitted_values)",
        "+ ",
        "  colnames(fitted_values_df) <- c(\"pred\", \"x\", \"y\")",
        "+ ",
        "  ",
        "+ ",
        "  print(r)",
        "+ ",
        "  breaks <- seq(floor(r[1]), ceiling(r[2]), length.out = 1)",
        "+ ",
        "  print(breaks)",
        "+ ",
        "  pp <- ggplot() +",
        "+ ",
        "    geom_tile(data = fitted_values_df, mapping = aes(x = x, y = y, fill = pred)) + ",
        "+ ",
        "    geom_sf(data = USA, color = \"black\", fill = NA, lwd = 0.5) +",
        "+ ",
        "    scale_fill_gradientn(name = \"PM2.5\", colors = rainbow(9, start = 0.1, end = 0.9), breaks = breaks, limits = c(breaks[1], tail(breaks, 1))) + ",
        "+ ",
        "    labs(x = \"\", y = \"\", title = tt) + ",
        "+ ",
        "    custom_theme + ",
        "+ ",
        "    theme(axis.text.x = element_blank(),",
        "+ ",
        "          axis.text.y = element_blank(),",
        "+ ",
        "          axis.ticks  = element_blank())",
        "+ ",
        "  ",
        "+ ",
        "  pp",
        "+ ",
        "} ",
        "> ",
        "plot_pred_USA(fitted_values = pred_mm, USA = USA, r = r, tt = \"Posterior Mean\")",
        "[1] -0.925845 16.448814\n[1] -1\n",
        "> ",
        "plot_pred_USA <- function (fitted_values, USA, r, tt = \"\", ...) {",
        "+ ",
        "  ",
        "+ ",
        "  coordinates(fitted_values) <- ~ x + y",
        "+ ",
        "  gridded(fitted_values) <- TRUE",
        "+ ",
        "  fitted_values <- raster(fitted_values)",
        "+ ",
        "  crs(fitted_values) <- \"+init=epsg:6345 +units=km +no_defs\"",
        "+ ",
        "  ",
        "+ ",
        "  fitted_values    <- as(fitted_values, \"SpatialPixelsDataFrame\")",
        "+ ",
        "  fitted_values_df <- as.data.frame(fitted_values)",
        "+ ",
        "  colnames(fitted_values_df) <- c(\"pred\", \"x\", \"y\")",
        "+ ",
        "  ",
        "+ ",
        "  breaks <- seq(floor(r[1]), ceiling(r[2]), length.out = 5)",
        "+ ",
        "  pp <- ggplot() +",
        "+ ",
        "    geom_tile(data = fitted_values_df, mapping = aes(x = x, y = y, fill = pred)) + ",
        "+ ",
        "    geom_sf(data = USA, color = \"black\", fill = NA, lwd = 0.5) +",
        "+ ",
        "    scale_fill_gradientn(name = \"PM2.5\", colors = rainbow(9, start = 0.1, end = 0.9), breaks = breaks, limits = c(breaks[1], tail(breaks, 1))) + ",
        "+ ",
        "    labs(x = \"\", y = \"\", title = tt) + ",
        "+ ",
        "    custom_theme + ",
        "+ ",
        "    theme(axis.text.x = element_blank(),",
        "+ ",
        "          axis.text.y = element_blank(),",
        "+ ",
        "          axis.ticks  = element_blank())",
        "+ ",
        "  ",
        "+ ",
        "  pp",
        "+ ",
        "} ",
        "> ",
        "plot_pred_USA(fitted_values = pred_mm, USA = USA, r = r, tt = \"Posterior Mean\")",
        "> ",
        "library(\"patchwork\")",
        "\nAttaching package: ‘patchwork’\n\nThe following object is masked from ‘package:raster’:\n\n    area\n\n",
        "> ",
        "pp_ll / pp_mm / pp_uu",
        "Error: object 'pp_ll' not found\n",
        "> ",
        "pp_mm <- plot_pred_USA(fitted_values = pred_mm, USA = USA, r = r, tt = \"Posterior Mean\")",
        "> ",
        "pp_ll <- plot_pred_USA(fitted_values = pred_mm, USA = USA, r = r, tt = \"Posterior  2.5th percentile\")",
        "> ",
        "pp_uu <- plot_pred_USA(fitted_values = pred_mm, USA = USA, r = r, tt = \"Posterior 97.5th percentile\")",
        "> ",
        "pp_ll / pp_mm / pp_uu",
        "> ",
        "pp_mm <- plot_pred_USA(fitted_values = pred_ll, USA = USA, r = r, tt = \"Posterior Mean\")",
        "> ",
        "pp_mm <- plot_pred_USA(fitted_values = pred_mm, USA = USA, r = r, tt = \"Posterior Mean\")",
        "> ",
        "pp_ll <- plot_pred_USA(fitted_values = pred_ll, USA = USA, r = r, tt = \"Posterior  2.5th percentile\")",
        "> ",
        "pp_uu <- plot_pred_USA(fitted_values = pred_uu, USA = USA, r = r, tt = \"Posterior 97.5th percentile\")",
        "> ",
        "(pp_ll / pp_mm / pp_uu)",
        "> ",
        "?inla.spde.make.index",
        "> ",
        "spde$n.spde",
        "[1] 680\n",
        "> ",
        "dim(A)",
        "[1] 942 680\n",
        "> ",
        "location",
        "function (df) \n{\n    lifecycle::deprecate_stop(\"1.0.0\", \"location()\", \"lobstr::ref()\")\n}\n<bytecode: 0x7f7ccddd41f8>\n<environment: namespace:dplyr>\n",
        "> ",
        "boundaries",
        "standardGeneric for \"boundaries\" defined from package \"terra\"\n\nfunction (x, ...) \nstandardGeneric(\"boundaries\")\n<bytecode: 0x7f7ce8d23840>\n<environment: 0x7f7ce8d31178>\nMethods may be defined for arguments: x\nUse  showMethods(boundaries)  for currently available ones.\n",
        "> ",
        "loc",
        "Error: object 'loc' not found\n",
        "> ",
        "pred_mm",
        "> ",
        "pred_mm %>% as_tibble() %>% rename(posterior_mean = V3) %>% head() ",
        "> ",
        "(pp_ll + pp_mm + pp_uu) & theme(legend.position = \"right\")",
        "> ",
        "(pp_ll + pp_mm + pp_uu) + plot_layout(guides = \"collect\") & theme(legend.position = \"right\")",
        "> ",
        "data_USA <- readRDS(file = \"data/example_4/data_USA.rds\")",
        "> ",
        "USA <- readRDS(file = \"data/example_4/USA_filtered.rds\")",
        "> ",
        "data_USA",
        "Simple feature collection with 942 features and 2 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: -2663.925 ymin: 2833.299 xmax: 1993.032 ymax: 6037.509\nProjected CRS: +init=epsg:6345 +units=km +no_defs\n",
        "> ",
        "USA",
        "Simple feature collection with 1 feature and 6 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: -2724.429 ymin: 2707.56 xmax: 2090.663 ymax: 6100.13\nProjected CRS: +init=epsg:6345 +units=km +no_defs\n         shapeName shapeISO                shapeID shapeGroup\n1.47 United States      USA USA-ADM0-1590546715-B1        USA\n     shapeType               area                       geometry\n1.47      ADM0 8.069899e+12 [m^2] POLYGON ((-91.01918 5501.72...\n",
        "> ",
        "ggplot() + ",
        "+ ",
        "  geom_sf(data = USA, fill = \"white\") +",
        "+ ",
        "  geom_sf(data = data_USA, color = \"black\", size = 3, shape = 1) +",
        "+ ",
        "  labs(x = \"\", y = \"\", title = \"\") +",
        "+ ",
        "  custom_theme + ",
        "+ ",
        "  theme(axis.text.x = element_blank(),",
        "+ ",
        "        axis.text.y = element_blank(),",
        "+ ",
        "        axis.ticks  = element_blank())",
        "> ",
        "ggplot() + ",
        "+ ",
        "  geom_sf(data = USA, fill = \"white\") +",
        "+ ",
        "  geom_sf(data = data_USA, color = \"black\", size = 3, shape = 2) +",
        "+ ",
        "  labs(x = \"\", y = \"\", title = \"\") +",
        "+ ",
        "  custom_theme + ",
        "+ ",
        "  theme(axis.text.x = element_blank(),",
        "+ ",
        "        axis.text.y = element_blank(),",
        "+ ",
        "        axis.ticks  = element_blank())",
        "> ",
        "ggplot() + ",
        "+ ",
        "  geom_sf(data = USA, fill = \"white\") +",
        "+ ",
        "  geom_sf(data = data_USA, color = \"black\", size = 3, shape = 3) +",
        "+ ",
        "  labs(x = \"\", y = \"\", title = \"\") +",
        "+ ",
        "  custom_theme + ",
        "+ ",
        "  theme(axis.text.x = element_blank(),",
        "+ ",
        "        axis.text.y = element_blank(),",
        "+ ",
        "        axis.ticks  = element_blank())",
        "> ",
        "saveRDS(object = mesh, file = \"data/example_4/mesh.RDS\")",
        "> ",
        "plot(mesh)",
        "\nRestarting R session...\n\n",
        "> ",
        "library(\"INLA\")",
        "Loading required package: Matrix\nLoading required package: sp\nThis is INLA_23.09.09 built 2023-10-16 17:35:11 UTC.\n - See www.r-inla.org/contact-us for how to get help.\n",
        "> ",
        "library(\"tidyverse\")",
        "── \u001B[1mAttaching core tidyverse packages\u001B[22m ───────────────────────────────── tidyverse 2.0.0 ──\n\u001B[32m✔\u001B[39m \u001B[34mdplyr    \u001B[39m 1.1.4     \u001B[32m✔\u001B[39m \u001B[34mreadr    \u001B[39m 2.1.5\n\u001B[32m✔\u001B[39m \u001B[34mforcats  \u001B[39m 1.0.0     \u001B[32m✔\u001B[39m \u001B[34mstringr  \u001B[39m 1.5.1\n\u001B[32m✔\u001B[39m \u001B[34mggplot2  \u001B[39m 3.5.0     \u001B[32m✔\u001B[39m \u001B[34mtibble   \u001B[39m 3.2.1\n\u001B[32m✔\u001B[39m \u001B[34mlubridate\u001B[39m 1.9.3     \u001B[32m✔\u001B[39m \u001B[34mtidyr    \u001B[39m 1.3.0\n\u001B[3",
        "2m✔\u001B[39m \u001B[34mpurrr    \u001B[39m 1.0.2     \n── \u001B[1mConflicts\u001B[22m ─────────────────────────────────────────────────── tidyverse_conflicts() ──\n\u001B[31m✖\u001B[39m \u001B[34mtidyr\u001B[39m::\u001B[32mexpand()\u001B[39m masks \u001B[34mMatrix\u001B[39m::expand()\n\u001B[31m✖\u001B[39m \u001B[34mdplyr\u001B[39m::\u001B[32mfilter()\u001B[39m masks \u001B[34mstats\u001B[39m::filter()\n\u001B[31m✖\u001B[39m \u001B[34mdplyr\u001B[39m::\u001B[32mlag()\u001B[39m    masks \u001B[34mstats\u001B[39m::lag()\n\u001B[31m✖\u001B[39m \u001B[3",
        "4mtidyr\u001B[39m::\u001B[32mpack()\u001B[39m   masks \u001B[34mMatrix\u001B[39m::pack()\n\u001B[31m✖\u001B[39m \u001B[34mtidyr\u001B[39m::\u001B[32munpack()\u001B[39m masks \u001B[34mMatrix\u001B[39m::unpack()\n\u001B[36mℹ\u001B[39m Use the \u001B]8;;http://conflicted.r-lib.org/\u0007conflicted package\u001B]8;;\u0007 to force all conflicts to become errors\n",
        "> ",
        "library(\"sf\")",
        "Linking to GEOS 3.11.0, GDAL 3.5.3, PROJ 9.1.0; sf_use_s2() is TRUE\n",
        "> ",
        "> ",
        "custom_theme <-  theme_bw() + theme(legend.position = \"right\", ",
        "+ ",
        "                                    text = element_text(size = 14, family = \"LM Roman 10\"),",
        "+ ",
        "                                    plot.title = element_text(size = 16),",
        "+ ",
        "                                    legend.title = element_text(size = 12))",
        "> ",
        "> ",
        "##################################################",
        "> ",
        "##################################################",
        "> ",
        "> ",
        "data_USA <- readRDS(file = \"data/example_4/data_USA.rds\")",
        "> ",
        "USA <- readRDS(file = \"data/example_4/USA_filtered.rds\")",
        "> ",
        "> ",
        "ggplot() + ",
        "+ ",
        "  geom_sf(data = USA, fill = \"white\") +",
        "+ ",
        "  geom_sf(data = data_USA, color = \"black\", size = 3, shape = 3) +",
        "+ ",
        "  labs(x = \"\", y = \"\", title = \"\") +",
        "+ ",
        "  custom_theme + ",
        "+ ",
        "  theme(axis.text.x = element_blank(),",
        "+ ",
        "        axis.text.y = element_blank(),",
        "+ ",
        "        axis.ticks  = element_blank())",
        "> ",
        "> ",
        "mesh <- readRDS(file = \"data/example_4/mesh.RDS\")",
        "> ",
        "plot(mesh)",
        "> ",
        "?inla.spde2.pcmatern",
        "\nRestarting R session...\n\n",
        "> ",
        "library(\"INLA\")",
        "Loading required package: Matrix\nLoading required package: sp\nThis is INLA_23.09.09 built 2023-10-16 17:35:11 UTC.\n - See www.r-inla.org/contact-us for how to get help.\n",
        "> ",
        "library(\"tidyverse\")",
        "── \u001B[1mAttaching core tidyverse packages\u001B[22m ───────────────────────────────── tidyverse 2.0.0 ──\n\u001B[32m✔\u001B[39m \u001B[34mdplyr    \u001B[39m 1.1.4     \u001B[32m✔\u001B[39m \u001B[34mreadr    \u001B[39m 2.1.5\n\u001B[32m✔\u001B[39m \u001B[34mforcats  \u001B[39m 1.0.0     \u001B[32m✔\u001B[39m \u001B[34mstringr  \u001B[39m 1.5.1\n\u001B[32m✔\u001B[39m \u001B[34mggplot2  \u001B[39m 3.5.0     \u001B[32m✔\u001B[39m \u001B[34mtibble   \u001B[39m 3.2.1\n\u001B[32m✔\u001B[39m \u001B[34mlubridate\u001B[39m 1.9.3     \u001B[32m✔\u001B[39m \u001B[34mtidyr    \u001B[39m 1.3.0\n\u001B[3",
        "2m✔\u001B[39m \u001B[34mpurrr    \u001B[39m 1.0.2     \n── \u001B[1mConflicts\u001B[22m ─────────────────────────────────────────────────── tidyverse_conflicts() ──\n\u001B[31m✖\u001B[39m \u001B[34mtidyr\u001B[39m::\u001B[32mexpand()\u001B[39m masks \u001B[34mMatrix\u001B[39m::expand()\n\u001B[31m✖\u001B[39m \u001B[34mdplyr\u001B[39m::\u001B[32mfilter()\u001B[39m masks \u001B[34mstats\u001B[39m::filter()\n\u001B[31m✖\u001B[39m \u001B[34mdplyr\u001B[39m::\u001B[32mlag()\u001B[39m    masks \u001B[34mstats\u001B[39m::lag()\n\u001B[31m✖\u001B[39m \u001B[3",
        "4mtidyr\u001B[39m::\u001B[32mpack()\u001B[39m   masks \u001B[34mMatrix\u001B[39m::pack()\n\u001B[31m✖\u001B[39m \u001B[34mtidyr\u001B[39m::\u001B[32munpack()\u001B[39m masks \u001B[34mMatrix\u001B[39m::unpack()\n\u001B[36mℹ\u001B[39m Use the \u001B]8;;http://conflicted.r-lib.org/\u0007conflicted package\u001B]8;;\u0007 to force all conflicts to become errors\n",
        "> ",
        "library(\"sf\")",
        "Linking to GEOS 3.11.0, GDAL 3.5.3, PROJ 9.1.0; sf_use_s2() is TRUE\n",
        "> ",
        "library(\"raster\")",
        "\nAttaching package: ‘raster’\n\nThe following object is masked from ‘package:dplyr’:\n\n    select\n\n",
        "> ",
        "library(\"patchwork\")",
        "\nAttaching package: ‘patchwork’\n\nThe following object is masked from ‘package:raster’:\n\n    area\n\n",
        "> ",
        "custom_theme <-  theme_bw() + theme(legend.position = \"right\", ",
        "+ ",
        "                                    text = element_text(size = 14, family = \"LM Roman 10\"),",
        "+ ",
        "                                    plot.title = element_text(size = 16),",
        "+ ",
        "                                    legend.title = element_text(size = 12))",
        "> ",
        "create_prediction_grid <- function (loc, resolution = 25, ...) {",
        "+ ",
        "  resolution <- 25 ",
        "+ ",
        "  pts_bdy <- loc$geometry[[1]][[1]]",
        "+ ",
        "  pts_bdy_x <- range(pts_bdy[, 1])",
        "+ ",
        "  pts_bdy_y <- range(pts_bdy[, 2])",
        "+ ",
        "  coord_pred <- expand.grid(x = seq(pts_bdy_x[1], pts_bdy_x[2], by = resolution), y = seq(pts_bdy_y[1], pts_bdy_y[2], by = resolution))",
        "+ ",
        "  coordinates(coord_pred) <- ~ x + y",
        "+ ",
        "  ",
        "+ ",
        "  xx <- as(st_as_sf(coord_pred), \"sf\");   st_crs(xx) <- st_crs(loc$geometry)",
        "+ ",
        "  yy <- as(st_as_sf(loc$geometry), \"sf\"); st_crs(yy) <- st_crs(loc$geometry)",
        "+ ",
        "  ",
        "+ ",
        "  # Compute intersection between grid and `loc` borders",
        "+ ",
        "  pppts <- st_intersection(x = xx, y = yy)",
        "+ ",
        "  ",
        "+ ",
        "  coord_pred <- matrix(data = NA, nrow = length(pppts$geometry), ncol = 2)",
        "+ ",
        "  colnames(coord_pred) <- c(\"x\", \"y\")",
        "+ ",
        "  for (p in 1:length(pppts$geometry)) { coord_pred[p, ] <- sf::st_coordinates(pppts$geometry[[p]]) }",
        "+ ",
        "  coord_pred <- data.frame(x = coord_pred[, 1], y = coord_pred[, 2])",
        "+ ",
        "  ",
        "+ ",
        "  as.matrix(coord_pred)",
        "+ ",
        "}",
        "> ",
        "plot_pred_USA <- function (fitted_values, USA, r, tt = \"\", ...) {",
        "+ ",
        "  ",
        "+ ",
        "  coordinates(fitted_values) <- ~ x + y",
        "+ ",
        "  gridded(fitted_values) <- TRUE",
        "+ ",
        "  fitted_values <- raster(fitted_values)",
        "+ ",
        "  crs(fitted_values) <- \"+init=epsg:6345 +units=km +no_defs\"",
        "+ ",
        "  ",
        "+ ",
        "  fitted_values    <- as(fitted_values, \"SpatialPixelsDataFrame\")",
        "+ ",
        "  fitted_values_df <- as.data.frame(fitted_values)",
        "+ ",
        "  colnames(fitted_values_df) <- c(\"pred\", \"x\", \"y\")",
        "+ ",
        "  ",
        "+ ",
        "  breaks <- seq(floor(r[1]), ceiling(r[2]), length.out = 5)",
        "+ ",
        "  pp <- ggplot() +",
        "+ ",
        "    geom_tile(data = fitted_values_df, mapping = aes(x = x, y = y, fill = pred)) + ",
        "+ ",
        "    geom_sf(data = USA, color = \"black\", fill = NA, lwd = 0.5) +",
        "+ ",
        "    scale_fill_gradientn(name = \"PM2.5\", colors = rainbow(9, start = 0.1, end = 0.9), breaks = breaks, limits = c(breaks[1], tail(breaks, 1))) + ",
        "+ ",
        "    labs(x = \"\", y = \"\", title = tt) + ",
        "+ ",
        "    custom_theme + ",
        "+ ",
        "    theme(axis.text.x = element_blank(),",
        "+ ",
        "          axis.text.y = element_blank(),",
        "+ ",
        "          axis.ticks  = element_blank())",
        "+ ",
        "  ",
        "+ ",
        "  pp",
        "+ ",
        "} ",
        "> ",
        "data_USA <- readRDS(file = \"data/example_4/data_USA.rds\")",
        "> ",
        "USA <- readRDS(file = \"data/example_4/USA_filtered.rds\")",
        "> ",
        "# Boundary coordinates",
        "> ",
        "USA_coor <- sf::st_coordinates(USA)",
        "> ",
        "USA_coor <- matrix(c(USA_coor[, 1], USA_coor[, 2]), ncol = 2)",
        "> ",
        "colnames(USA_coor) <- c(\"lon\", \"lat\")",
        "> ",
        "# Points coordinates",
        "> ",
        "data_coor <- sf::st_coordinates(data_USA)",
        "> ",
        "data_USA  <- bind_cols(data_USA, as_tibble(data_coor))",
        "> ",
        "data_USA  <- data_USA %>% rename(lon = X, lat = Y) %>% dplyr::select(mean, sd, lon, lat, geometry)",
        "> ",
        "mesh <- inla.mesh.2d(loc.domain = USA_coor, max.edge = c(300, 3000), offset = c(300, 1500))",
        "> ",
        "saveRDS(object = mesh, file = \"data/example_4/mesh.RDS\")",
        "> ",
        "mesh$n # Number of nodes",
        "[1] 680\n",
        "> ",
        "# Plot `mesh`",
        "> ",
        "{ ",
        "+ ",
        "  plot(mesh)",
        "+ ",
        "  plot(USA$geometry, lwd = 2, border = \"red\", add = TRUE)",
        "+ ",
        "  points(data_USA$lon, data_USA$lat, pch = 1, col = \"green\") ",
        "+ ",
        "}",
        "> ",
        "# Flexible parameterization (with a default one)",
        "> ",
        "# spde <- inla.spde2.matern(mesh = mesh, alpha = 2)",
        "> ",
        "# Parameterization for PC priors",
        "> ",
        "spde <- inla.spde2.pcmatern(mesh = mesh, ",
        "+ ",
        "                            alpha = 2,",
        "+ ",
        "                            prior.range = c(1e3, 0.90), # P(range < 1e3) = 0.90",
        "+ ",
        "                            prior.sigma = c(1.0, 0.01)) # P(sigma > 1.0) = 0.01",
        "> ",
        "saveRDS(object = spde, file = \"data/example_4/spde.RDS\")",
        "\nRestarting R session...\n\n",
        "\nRestarting R session...\n\n"
    ]
}